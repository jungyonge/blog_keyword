<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Setalarm">

    <select id="getKeywordMaster" resultType="HashMap" >
        SELECT
              keyword
        FROM keyword_master
        WHERE used = '사용안함';
    </select>

    <select id="getKeywordRelate1" resultType="HashMap" >
        SELECT
        keyword_rel
        FROM keyword_relate
        WHERE used = '사용안함' and id between 77882 and 400000;

    </select>


    <select id="getMakeKeywordRelate" resultType="HashMap" >
        SELECT
              keyword_rel
        FROM keyword_relate
        WHERE used = '사용안함' AND make ='make';
    </select>


    <select id="getKeywordMasterForMake" resultType="HashMap" parameterType="map">
        SELECT
              st1
        FROM ${table}
        WHERE st1 !='';
    </select>

    <select id="getKeywordRelateForMake" resultType="HashMap" parameterType="map">
        SELECT
               st2
        FROM ${table}
        WHERE st2 !='';
    </select>

    <insert id="insertKeyword_Master" useGeneratedKeys="true" keyProperty="id" parameterType="map">
        INSERT INTO
        keyword_master (keyword)
        VALUES (#{keyword});
    </insert>

    <insert id="insertKeyword_Relate" useGeneratedKeys="true" keyProperty="id" parameterType="map">
        INSERT INTO
        keyword_relate (keyword_rel)
        VALUES (#{keyword});
    </insert>

    <insert id="insertMakeKeyword_Relate" useGeneratedKeys="true" keyProperty="id" parameterType="map">
        INSERT INTO
        keyword_relate (keyword_rel, make)
        VALUES (#{keyword} ,#{make});
    </insert>


    <insert id="insertKeywordStat" useGeneratedKeys="true" keyProperty="id" parameterType="map">
        INSERT INTO
            keyword_stat(relKeyword, monthlyPcQcCnt, monthlyMobileQcCnt, monthlyAvePcClkCnt,
                        monthlyAveMobileClkCnt, monthlyAvePcCtr, monthlyAveMobileCtr, plAvgDepth,
                        compIdx, totalPost, naverCnt, tistoryCnt, elseCnt, whereBlog, whereWeb, whereMobileBlog, whereMobileWeb ,make)
        VALUE
              (#{relKeyword}, #{monthlyPcQcCnt}, #{monthlyMobileQcCnt}, #{monthlyAvePcClkCnt},
              #{monthlyAveMobileClkCnt}, #{monthlyAvePcCtr}, #{monthlyAveMobileCtr}, #{plAvgDepth},
              #{compIdx}, #{totalPost}, #{naverCnt}, #{tistoryCnt}, #{elseCnt}, #{whereBlog}, #{whereWeb}, #{whereMobileBlog}, #{whereMobileWeb} ,#{make})
    </insert>

    <delete id="deleteKeyword_Master">
        DELETE FROM keyword_master WHERE
           id NOT IN (SELECT * FROM (SELECT MIN(id) FROM keyword_master GROUP BY keyword) AS temp);
    </delete>

    <delete id="deleteKeyword_Relete">
        DELETE FROM keyword_relate WHERE
           id NOT IN (SELECT * FROM (SELECT MIN(id) FROM keyword_relate GROUP BY keyword_rel) AS temp);
    </delete>

    <update id="updateUsed_Master">
      UPDATE keyword_master
        SET used = '사용함'
          WHERE keyword = #{keyword};
    </update>

    <update id="updateUsed_Relate" parameterType="map">
      UPDATE keyword_relate
        SET used = '사용함'
          WHERE keyword_rel = #{keyword_rel};
    </update>

    <insert id="insertBasketStat" parameterType="blog.model.BasketballModel">
    INSERT INTO sport.basketball_data (
            GAME_ID,
            LEAGUE,
            GROUND,
            MATCH_DATE,
            DAY_OF_WEEK,
            MATCH_TIME,
            A_TEAM,
            A_TEAM_TOTAL_POINT,
            B_TEAM_TOTAL_POINT,
            B_TEAM,
            HANDI_CAP,
            HANDI_CAP_RESULT,
            POINT_LINE,
            POINT_LINE_RESULT,
            A_TEAM_FIRSTQ_POINT,
            B_TEAM_FIRSTQ_POINT,
            FIRSTQ_HANDI_CAP,
            FIRSTQ_HANDI_CAP_RESULT,
            FIRSTQ_POINT_LINE,
            FIRSTQ_POINT_LINE_RESUL,
            A_TEAM_SECONDQ_POINT,
	        B_TEAM_SECONDQ_POINT,
	        SECONDQ_HANDI_CAP_RESULT,
	        SECONDQ_POINT_LINE_RESULT,
	        A_TEAM_THIRDQ_POINT,
	        B_TEAM_THIRDQ_POINT,
	        THIRDQ_HANDI_CAP_RESULT,
	        THIRDQ_POINT_LINE_RESULT,
	        A_TEAM_FOURTHQ_POINT,
	        B_TEAM_FOURTHQ_POINT,
	        FOURTHQ_HANDI_CAP_RESULT,
	        FOURTHQ_POINT_LINE_RESULT,
            FIRSTQ_FIRST_POINT,
            FIRSTQ_FIRST_FREE_TWO,
            FIRSTQ_FIRST_TWO_POINT,
            FIRSTQ_FIRST_THREE_POINT,
            SECONDQ_FIRST_POINT,
            SECONDQ_FIRST_FREE_TWO,
            SECONDQ_FIRST_TWO_POINT,
            SECONDQ_FIRST_THREE_POINT,
            THIRDQ_FIRST_POINT,
            THIRDQ_FIRST_FREE_TWO,
            THIRDQ_FIRST_TWO_POINT,
            THIRDQ_FIRST_THREE_POINT,
            FOURTHQ_FIRST_POINT,
            FOURTHQ_FIRST_FREE_TW,
            FOURTHQ_FIRST_TWO_POINT,
            FOURTHQ_FIRST_THREE_POINT,
            FIRSTQ_TOTAL_POINT,
            SECONDQ_TOTAL_POINT,
            THIRDQ_TOTAL_POINT,
            FOURTHQ_TOTAL_POINT,
            EXTENDQ_TOTAL_POINT,
            )
      VALUES (
                #{gameId},
                #{league},
                #{ground},
                #{date},
                #{dayOfWeek},
                #{time},
                #{aTeam},
                #{aTeamTotalPoint},
                #{bTeamTotalPoint},
                #{bTeam},
                #{handiCap},
                #{handiCapResult},
                #{pointLine},
                #{pointLineResult},
                #{aTeamFirstQPoint},
                #{bTeamFirstQPoint},
                #{firstQHandiCap},
                #{firstQHandiCapResult},
                #{firstQPointLine},
                #{firstQPointLineResult},
                #{aTeamSecondQPoint},
                #{bTeamSecondQPoint},
                #{secondQHandiCapResult},
                #{secondQPointLineResult},
                #{aTeamThirdQPoint},
                #{bTeamThirdQPoint},
                #{thirdQHandiCapResult},
                #{thirdQPointLineResult},
                #{aTeamFourthQPoint},
                #{bTeamFourthQPoint},
                #{fourthQHandiCapResult},
                #{fourthQPointLineResult},
                #{firstQFirstPoint},
                #{firstQFirstFreeTwo},
                #{firstQFirstTwoPoint},
                #{firstQFirstThreePoint},
                #{secondQFirstPoint},
                #{secondQFirstFreeTwo},
                #{secondQFirstTwoPoint},
                #{secondQFirstThreePoint},
                #{thirdQFirstPoint},
                #{thirdQFirstFreeTwo},
                #{thirdQFirstTwoPoint},
                #{thirdQFirstThreePoint},
                #{fourthQFirstPoint},
                #{fourthQFirstFreeTwo},
                #{fourthQFirstTwoPoint},
                #{fourthQFirstThreePoint},
                #{firstQTotalPoint},
                #{secondQTotalPoint},
                #{thirdQTotalPoint},
                #{fourthQTotalPoint},
                #{extendQTotalPoint}
            )
    </insert>

    <update id="updateBasketStat" parameterType="blog.model.BasketballModel">
    UPDATE sport.basketball_data
            SET
                A_TEAM_TOTAL_POINT   =     #{aTeamTotalPoint},
                B_TEAM_TOTAL_POINT   =     #{bTeamTotalPoint},
                HANDI_CAP   =     #{handiCap},
                HANDI_CAP_RESULT   =     #{handiCapResult},
                ODD            = #{odd},
                POINT_LINE   =     #{pointLine},
                POINT_LINE_RESULT   =     #{pointLineResult},
                A_TEAM_FIRSTQ_POINT   =     #{aTeamFirstQPoint},
                B_TEAM_FIRSTQ_POINT   =     #{bTeamFirstQPoint},
                FIRSTQ_HANDI_CAP   =     #{firstQHandiCap},
                FIRSTQ_HANDI_CAP_RESULT   =     #{firstQHandiCapResult},
                FIRSTQ_POINT_LINE   =     #{firstQPointLine},
                FIRSTQ_POINT_LINE_RESULT   =     #{firstQPointLineResult},
                A_TEAM_SECONDQ_POINT   =     #{aTeamSecondQPoint},
	            B_TEAM_SECONDQ_POINT   =     #{bTeamSecondQPoint},
	            SECONDQ_HANDI_CAP_RESULT   =     #{secondQHandiCapResult},
	            SECONDQ_POINT_LINE_RESULT   =     #{secondQPointLineResult},
	            A_TEAM_THIRDQ_POINT   =     #{aTeamThirdQPoint},
	            B_TEAM_THIRDQ_POINT   =     #{bTeamThirdQPoint},
	            THIRDQ_HANDI_CAP_RESULT   =     #{thirdQHandiCapResult},
	            THIRDQ_POINT_LINE_RESULT   =     #{thirdQPointLineResult},
	            A_TEAM_FOURTHQ_POINT   =     #{aTeamFourthQPoint},
	            B_TEAM_FOURTHQ_POINT   =     #{bTeamFourthQPoint},
	            FOURTHQ_HANDI_CAP_RESULT   =     #{fourthQHandiCapResult},
	            FOURTHQ_POINT_LINE_RESULT   =     #{fourthQPointLineResult},
	            A_TEAM_FIRST_HALF_POINT     =     #{aTeamFirstHalfPoint},
                B_TEAM_FIRST_HALF_POINT     =     #{bTeamFirstHalfPoint},
                HALF_HANDI_CAP      =     #{halfHandiCap},
                FIRST_HALF_HANDI_CAP_RESULT     =     #{firstHalfHandiCapResult},
                HALF_POINT_LINE     =     #{halfPointLine},
                FIRST_HALF_POINT_LINE_RESULT        =     #{firstHalfPointLineResult},
                A_TEAM_SECOND_HALF_POINT        =     #{aTeamSecondHalfPoint},
                B_TEAM_SECOND_HALF_POINT        =     #{bTeamSecondHalfPoint},
                SECOND_HALF_HANDI_CAP_RESULT        =     #{secondHalfHandiCapResult},
                SECOND_HALF_POINT_LINE_RESULT       =     #{secondHalfPointLineResult},
                FIRSTQ_FIRST_POINT   =     #{firstQFirstPoint},
                FIRSTQ_FIRST_FREE_TWO   =     #{firstQFirstFreeTwo},
                FIRSTQ_FIRST_TWO_POINT   =     #{firstQFirstTwoPoint},
                FIRSTQ_FIRST_THREE_POINT   =     #{firstQFirstThreePoint},
                SECONDQ_FIRST_POINT   =     #{secondQFirstPoint},
                SECONDQ_FIRST_FREE_TWO   =     #{secondQFirstFreeTwo},
                SECONDQ_FIRST_TWO_POINT   =     #{secondQFirstTwoPoint},
                SECONDQ_FIRST_THREE_POINT   =     #{secondQFirstThreePoint},
                THIRDQ_FIRST_POINT   =     #{thirdQFirstPoint},
                THIRDQ_FIRST_FREE_TWO   =     #{thirdQFirstFreeTwo},
                THIRDQ_FIRST_TWO_POINT   =     #{thirdQFirstTwoPoint},
                THIRDQ_FIRST_THREE_POINT   =     #{thirdQFirstThreePoint},
                FOURTHQ_FIRST_POINT   =     #{fourthQFirstPoint},
                FOURTHQ_FIRST_FREE_TWO   =     #{fourthQFirstFreeTwo},
                FOURTHQ_FIRST_TWO_POINT   =     #{fourthQFirstTwoPoint},
                FOURTHQ_FIRST_THREE_POINT   =     #{fourthQFirstThreePoint},
                FIRSTQ_TOTAL_POINT   =     #{firstQTotalPoint},
                SECONDQ_TOTAL_POINT   =     #{secondQTotalPoint},
                THIRDQ_TOTAL_POINT   =     #{thirdQTotalPoint},
                FOURTHQ_TOTAL_POINT   =     #{fourthQTotalPoint},
                EXTENDQ_TOTAL_POINT   =     #{extendQTotalPoint}
            WHERE
                GAME_ID   =     #{gameId} AND
                LEAGUE   =     #{league} AND
                GROUND   =     #{ground} AND
                MATCH_DATE   =     #{date} AND
                A_TEAM   =     #{aTeam} AND
                B_TEAM   =     #{bTeam}
    </update>

    <update id="updateTomorrowBasketStat" parameterType="blog.model.BasketballModel">
    UPDATE sport.basketball_data
        SET
            ODD            = #{odd}
        WHERE
            GAME_ID   =     #{gameId} AND
            LEAGUE   =     #{league} AND
            GROUND   =     #{ground} AND
            MATCH_DATE   =     #{date} AND
            A_TEAM   =     #{aTeam} AND
            B_TEAM   =     #{bTeam}
    </update>

    <update id="updateTomorrowHockeyStat" parameterType="blog.model.HockeyModel">
        UPDATE sport.hockey_data
        SET
            ODD            = #{odd}
        WHERE
            GAME_ID   =     #{gameId} AND
            LEAGUE   =     #{league} AND
            GROUND   =     #{ground} AND
            MATCH_DATE   =     #{date} AND
            A_TEAM   =     #{aTeam} AND
            B_TEAM   =     #{bTeam}
    </update>

    <insert id="insertBasketMatch" parameterType="blog.model.BasketballModel">
        INSERT INTO sport.basketball_data(GAME_ID, LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY,  A_TEAM, B_TEAM, B_TEAM_REST_DAY)
      VALUES (
                #{gameId},
                #{league},
                #{ground},
                #{date},
                #{dayOfWeek},
                #{time},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.basketball_data A WHERE A_TEAM = #{aTeam} ORDER BY idx DESC LIMIT 1))) -1,0),
                #{aTeam},
                #{bTeam},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.basketball_data B WHERE B_TEAM = #{bTeam} ORDER BY idx DESC LIMIT 1))) -1,0)
            )
    </insert>

    <select id="selectBasketStat"  resultType="HashMap">
        SELECT LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY, A_TEAM, A_TEAM_TOTAL_POINT, B_TEAM_TOTAL_POINT, B_TEAM, B_TEAM_REST_DAY, HANDI_CAP, HANDI_CAP_RESULT, ODD, POINT_LINE, POINT_LINE_RESULT, A_TEAM_FIRSTQ_POINT, B_TEAM_FIRSTQ_POINT, FIRSTQ_HANDI_CAP, FIRSTQ_HANDI_CAP_RESULT, FIRSTQ_POINT_LINE, FIRSTQ_POINT_LINE_RESULT, A_TEAM_SECONDQ_POINT, B_TEAM_SECONDQ_POINT, SECONDQ_HANDI_CAP_RESULT, SECONDQ_POINT_LINE_RESULT, A_TEAM_THIRDQ_POINT, B_TEAM_THIRDQ_POINT, THIRDQ_HANDI_CAP_RESULT, THIRDQ_POINT_LINE_RESULT, A_TEAM_FOURTHQ_POINT, B_TEAM_FOURTHQ_POINT, FOURTHQ_HANDI_CAP_RESULT, FOURTHQ_POINT_LINE_RESULT, A_TEAM_FIRST_HALF_POINT, B_TEAM_FIRST_HALF_POINT, HALF_HANDI_CAP, FIRST_HALF_HANDI_CAP_RESULT, HALF_POINT_LINE, FIRST_HALF_POINT_LINE_RESULT, A_TEAM_SECOND_HALF_POINT, B_TEAM_SECOND_HALF_POINT, SECOND_HALF_HANDI_CAP_RESULT, SECOND_HALF_POINT_LINE_RESULT, FIRSTQ_FIRST_POINT, FIRSTQ_FIRST_FREE_TWO, FIRSTQ_FIRST_TWO_POINT, FIRSTQ_FIRST_THREE_POINT, SECONDQ_FIRST_POINT, SECONDQ_FIRST_FREE_TWO, SECONDQ_FIRST_TWO_POINT, SECONDQ_FIRST_THREE_POINT, THIRDQ_FIRST_POINT, THIRDQ_FIRST_FREE_TWO, THIRDQ_FIRST_TWO_POINT, THIRDQ_FIRST_THREE_POINT, FOURTHQ_FIRST_POINT, FOURTHQ_FIRST_FREE_TWO, FOURTHQ_FIRST_TWO_POINT, FOURTHQ_FIRST_THREE_POINT, FIRSTQ_TOTAL_POINT, SECONDQ_TOTAL_POINT, THIRDQ_TOTAL_POINT, FOURTHQ_TOTAL_POINT, EXTENDQ_TOTAL_POINT
            FROM sport.basketball_data
        ORDER BY MATCH_DATE,GAME_ID;
    </select>

    <insert id="insertVolleyMatch" parameterType="blog.model.VolleyballModel">
        INSERT INTO sport.volleyball_data(GAME_ID, LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY,  A_TEAM, B_TEAM, B_TEAM_REST_DAY)
      VALUES (
                #{gameId},
                #{league},
                #{ground},
                #{date},
                #{dayOfWeek},
                #{time},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.volleyball_data A WHERE A_TEAM = #{aTeam} ORDER BY idx DESC LIMIT 1))) -1,0),
                #{aTeam},
                #{bTeam},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.volleyball_data B WHERE B_TEAM = #{bTeam} ORDER BY idx DESC LIMIT 1))) -1,0)
            )
    </insert>

    <update id="updateVolleyStat" parameterType="blog.model.VolleyballModel">
             UPDATE sport.volleyball_data
                     SET
                A_TEAM_SET_POINT        =           #{aTeamSetScore}    ,
                A_TEAM_TOTAL_POINT      =           #{aTeamTotalPoint}  ,
                B_TEAM_TOTAL_POINT      =           #{bTeamTotalPoint}  ,
                B_TEAM_SET_POINT        =           #{bTeamSetScore}    ,
                ODD                     =               #{odd} ,
                HANDI_CAP       =           #{handiCap} ,
                HANDI_CAP_RESULT        =           #{handiCapResult}   ,
                SET_HANDI_CAP       =           #{setHandiCap}  ,
                SET_HANDI_CAP_RESULT        =           #{setHandiCapResult}    ,
                POINT_LINE      =           #{pointLine}    ,
                POINT_LINE_RESULT       =           #{pointLineResult}  ,

                A_TEAM_FIRSTQ_POINT     =           #{aTeamFirstQPoint} ,
                B_TEAM_FIRSTQ_POINT     =           #{bTeamFirstQPoint} ,
                FIRSTQ_RESULT           =           #{firstQResult},
                FIRSTQ_HANDI_CAP        =           #{firstQHandiCap}   ,
                FIRSTQ_HANDI_CAP_RESULT     =           #{firstQHandiCapResult} ,
                FIRSTQ_POINT_LINE       =           #{firstQPointLine}  ,
                FIRSTQ_POINT_LINE_RESULT        =           #{firstQPointLineResult}    ,

                A_TEAM_SECONDQ_POINT   =     #{aTeamSecondQPoint},
	            B_TEAM_SECONDQ_POINT   =     #{bTeamSecondQPoint},
	            SECONDQ_RESULT           =           #{secondQResult},
	            SECONDQ_HANDI_CAP_RESULT   =     #{secondQHandiCapResult},
	            SECONDQ_POINT_LINE_RESULT   =     #{secondQPointLineResult},

	            A_TEAM_THIRDQ_POINT   =     #{aTeamThirdQPoint},
	            B_TEAM_THIRDQ_POINT   =     #{bTeamThirdQPoint},
	            THIRDQ_RESULT           =           #{thirdQResult},
	            THIRDQ_HANDI_CAP_RESULT   =     #{thirdQHandiCapResult},
	            THIRDQ_POINT_LINE_RESULT   =     #{thirdQPointLineResult},

	            A_TEAM_FOURTHQ_POINT   =     #{aTeamFourthQPoint},
	            B_TEAM_FOURTHQ_POINT   =     #{bTeamFourthQPoint},
	            FOURTHQ_RESULT           =           #{fourthQResult},
	            FOURTHQ_HANDI_CAP_RESULT   =     #{fourthQHandiCapResult},
	            FOURTHQ_POINT_LINE_RESULT   =     #{fourthQPointLineResult},

	            A_TEAM_FIFTHQ_POINT   =     #{aTeamFifthQPoint},
	            B_TEAM_FIFTHQ_POINT   =     #{bTeamFifthQPoint},
	            FIFTHQ_RESULT           =           #{fifthQResult},
	            FIFTHQ_HANDI_CAP_RESULT   =     #{fifthQHandiCapResult},

                FIRST_POINT         =           #{firstPoint}   ,
                FIRST_BLOCK        =            #{firstBlock}   ,
                FIRST_SERVE         =           #{firstServe}   ,
                FIRST_5POINT       =            #{first5Point}  ,
                FIRST_7POINT        =           #{first7Point}  ,
                FIRST_10POINT       =           #{first10Point} ,
                FIRSTQ_POINT        =           #{firstQPoint}  ,
                SECONDQ_POINT       =           #{secondQPoint} ,
                THIRDQ_POINT        =           #{thirdQPoint}  ,
                FOURTHQ_POINT       =           #{fourthQPoint} ,
                FIFTHDQ_POINT       =           #{fifthQPoint}  ,
                FIRSTQ_TOTAL_POINT      =           #{firstQTotalPoint} ,
                SECONDQ_TOTAL_POINT     =           #{secondQTotalPoint}    ,
                THIRDQ_TOTAL_POINT      =           #{thirdQTotalPoint} ,
                FOURTHQ_TOTAL_POINT     =           #{fourthQTotalPoint}    ,
                FIFTHDQ_TOTAL_POINT     =           #{fifthQTotalPoint}
        WHERE
                GAME_ID     =           #{gameId}   AND
                LEAGUE      =           #{league}   AND
                GROUND      =           #{ground}   AND
                MATCH_DATE      =           #{date} AND
                A_TEAM      =           #{aTeam}    AND
                B_TEAM      =    #{bTeam}
    </update>

    <insert id="insertVolleyStat"  parameterType="blog.model.VolleyballModel">
        INSERT INTO sport.volleyball_data (
        GAME_ID,
        LEAGUE,
        GROUND,
        MATCH_DATE,
        DAY_OF_WEEK,
        MATCH_TIME,
        A_TEAM,
        A_TEAM_SET_POINT,
        A_TEAM_TOTAL_POINT,
        B_TEAM_TOTAL_POINT,
        B_TEAM_SET_POINT,
        B_TEAM, HANDI_CAP,
        HANDI_CAP_RESULT,
        SET_HANDI_CAP,
        SET_HANDI_CAP_RESULT,
        POINT_LINE,
        POINT_LINE_RESULT,
        A_TEAM_FIRSTQ_POINT,
        B_TEAM_FIRSTQ_POINT,
        FIRSTQ_HANDI_CAP,
        FIRSTQ_HANDI_CAP_RESULT,
        FIRSTQ_POINT_LINE,
        FIRSTQ_POINT_LINE_RESULT,
        FIRST_POINT, FIRST_BLOCK,
        FIRST_SERVE, FIRST_5POINT,
        FIRST_7POINT,
        FIRST_10POINT,
        FIRSTQ_POINT,
        SECONDQ_POINT,
        THIRDQ_POINT,
        FOURTHQ_POINT,
        FIFTHDQ_POINT,
        FIRSTQ_TOTAL_POINT,
        SECONDQ_TOTAL_POINT,
        THIRDQ_TOTAL_POINT,
        FOURTHQ_TOTAL_POINT,
        FIFTHDQ_TOTAL_POINT
        )

        VALUES(

          #{gameId},
          #{league},
          #{ground},
          #{date},
          #{dayOfWeek},
          #{time},
          #{aTeam},
          #{aTeamSetScore},
          #{aTeamTotalPoint},
          #{bTeamTotalPoint},
          #{bTeamSetScore},
          #{bTeam},
          #{handiCap},
          #{handiCapResult},
          #{setHandiCap},
          #{setHandiCapResult},
          #{pointLine},
          #{pointLineResult},
          #{aTeamFirstQPoint},
          #{bTeamFirstQPoint},
          #{firstQHandiCap},
          #{firstQHandiCapResult},
          #{firstQPointLine},
          #{firstQPointLineResult},
          #{firstPoint},
          #{firstBlock},
          #{firstServe},
          #{first5Point},
          #{first7Point},
          #{first10Point},
          #{firstQPoint},
          #{secondQPoint},
          #{thirdQPoint},
          #{fourthQPoint},
          #{fifthQPoint},
          #{firstQTotalPoint},
          #{secondQTotalPoint},
          #{thirdQTotalPoint},
          #{fourthQTotalPoint},
          #{fifthQTotalPoint}
     )
    </insert>

    <select id="selectVolleyStat"  resultType="HashMap">
        SELECT  LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY, A_TEAM, A_TEAM_SET_POINT, A_TEAM_TOTAL_POINT, B_TEAM_TOTAL_POINT, B_TEAM_SET_POINT, B_TEAM, B_TEAM_REST_DAY, HANDI_CAP, HANDI_CAP_RESULT, ODD, SET_HANDI_CAP, SET_HANDI_CAP_RESULT, POINT_LINE, POINT_LINE_RESULT, A_TEAM_FIRSTQ_POINT, B_TEAM_FIRSTQ_POINT, FIRSTQ_RESULT, FIRSTQ_HANDI_CAP, FIRSTQ_HANDI_CAP_RESULT, FIRSTQ_POINT_LINE, FIRSTQ_POINT_LINE_RESULT, A_TEAM_SECONDQ_POINT, B_TEAM_SECONDQ_POINT, SECONDQ_RESULT, SECONDQ_HANDI_CAP_RESULT, SECONDQ_POINT_LINE_RESULT, A_TEAM_THIRDQ_POINT, B_TEAM_THIRDQ_POINT, THIRDQ_RESULT, THIRDQ_HANDI_CAP_RESULT, THIRDQ_POINT_LINE_RESULT, A_TEAM_FOURTHQ_POINT, B_TEAM_FOURTHQ_POINT, FOURTHQ_RESULT, FOURTHQ_HANDI_CAP_RESULT, FOURTHQ_POINT_LINE_RESULT, A_TEAM_FIFTHQ_POINT, B_TEAM_FIFTHQ_POINT, FIFTHQ_RESULT, FIFTHQ_HANDI_CAP_RESULT, FIRST_POINT, FIRST_BLOCK, FIRST_SERVE, FIRST_5POINT, FIRST_7POINT, FIRST_10POINT, FIRSTQ_POINT, SECONDQ_POINT, THIRDQ_POINT, FOURTHQ_POINT, FIFTHDQ_POINT, FIRSTQ_TOTAL_POINT, SECONDQ_TOTAL_POINT, THIRDQ_TOTAL_POINT, FOURTHQ_TOTAL_POINT, FIFTHDQ_TOTAL_POINT
            FROM sport.volleyball_data
        ORDER BY MATCH_DATE,GAME_ID;
    </select>

    <insert id="insertHockeyMatch" parameterType="blog.model.HockeyModel">
        INSERT INTO sport.hockey_data(GAME_ID, LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY,  A_TEAM, B_TEAM, B_TEAM_REST_DAY)
      VALUES (
                #{gameId},
                #{league},
                #{ground},
                #{date},
                #{dayOfWeek},
                #{time},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.hockey_data A WHERE A_TEAM = #{aTeam} ORDER BY idx DESC LIMIT 1))) -1,0),
                #{aTeam},
                #{bTeam},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.hockey_data B WHERE B_TEAM = #{bTeam} ORDER BY idx DESC LIMIT 1))) -1,0)
            )
    </insert>

    <update id="updateHockeyStat" parameterType="blog.model.HockeyModel">
        UPDATE sport.hockey_data
    SET
        A_TEAM_TOTAL_POINT              =           #{aTeamTotalPoint},
        B_TEAM_TOTAL_POINT              =           #{bTeamTotalPoint},
        HANDI_CAP               =           #{handiCap},
        HANDI_CAP_RESULT                =           #{handiCapResult},
        ODD             =               #{odd},
        POINT_LINE              =           #{pointLine},
        POINT_LINE_RESULT               =           #{pointLineResult},
        A_TEAM_FIRSTQ_POINT             =           #{aTeamFirstQPoint},
        B_TEAM_FIRSTQ_POINT             =           #{bTeamFirstQPoint},
        FIRSTQ_HANDI_CAP                =           #{firstQHandiCap},
        FIRSTQ_HANDI_CAP_RESULT             =           #{firstQHandiCapResult},
        FIRSTQ_POINT_LINE               =           #{firstQPointLine},
        FIRSTQ_POINT_LINE_RESULT                =           #{firstQPointLineResult},
        FIRST_POINT             =           #{firstPoint},
        FIRSTQ_POINT                =           #{firstQPoint},
        SECONDQ_POINT               =           #{secondQPoint},
        THIRDQ_POINT                =           #{thirdQPoint},
        EXTENDQ_POINT               =           #{extendQPoint},
        SHOTOUTQ_POINT              =           #{shotoutQPoint},
        FIRSTQ_TOTAL_POINT              =           #{firstQTotalPoint},
        SECONDQ_TOTAL_POINT             =           #{secondQTotalPoint},
        THIRDQ_TOTAL_POINT              =           #{thirdQTotalPoint},
        EXTENDQ_TOTAL_POINT             =           #{extendQTotalPoint},
        SHOTOUTQ_TOTAL_POINT                =           #{shotoutQTotalPoint}

    WHERE
        GAME_ID             =           #{gameId}   AND
        LEAGUE              =           #{league}   AND
        GROUND              =           #{ground}   AND
        MATCH_DATE              =           #{date} AND
        A_TEAM              =           #{aTeam}    AND
        B_TEAM              =           #{bTeam}
    </update>

    <insert id="insertHockeyStat" parameterType="blog.model.HockeyModel">
        INSERT INTO sport.hockey_data (
        GAME_ID,
        LEAGUE, GROUND,
        MATCH_DATE,
        DAY_OF_WEEK,
        MATCH_TIME,
        A_TEAM,
        A_TEAM_TOTAL_POINT,
        B_TEAM_TOTAL_POINT,
        B_TEAM,
        HANDI_CAP,
        HANDI_CAP_RESULT,
        POINT_LINE,
        POINT_LINE_RESULT,
        A_TEAM_FIRSTQ_POINT,
        B_TEAM_FIRSTQ_POINT,
        FIRSTQ_HANDI_CAP,
        FIRSTQ_HANDI_CAP_RESULT,
        FIRSTQ_POINT_LINE,
        FIRSTQ_POINT_LINE_RESULT,
        FIRST_POINT,
        FIRSTQ_POINT,
        SECONDQ_POINT,
        THIRDQ_POINT,
        EXTENDQ_POINT,
        SHOTOUTQ_POINT,
        FIRSTQ_TOTAL_POINT,
        SECONDQ_TOTAL_POINT,
        THIRDQ_TOTAL_POINT,
        EXTENDQ_TOTAL_POINT,
        SHOTOUTQ_TOTAL_POINT
        )
        VALUES (
           #{gameId},
           #{league},
           #{ground},
           #{date},
           #{dayOfWeek},
           #{time},
           #{aTeam},
           #{aTeamTotalPoint},
           #{bTeamTotalPoint},
           #{bTeam},
           #{handiCap},
           #{handiCapResult},
           #{pointLine},
           #{pointLineResult},
           #{aTeamFirstQPoint},
           #{bTeamFirstQPoint},
           #{firstQHandiCap},
           #{firstQHandiCapResult},
           #{firstQPointLine},
           #{firstQPointLineResult},
           #{firstPoint},
           #{firstQPoint},
           #{secondQPoint},
           #{thirdQPoint},
           #{extendQPoint},
           #{shotoutQPoint},
           #{firstQTotalPoint},
           #{secondQTotalPoint},
           #{thirdQTotalPoint},
           #{extendQTotalPoint},
           #{shotoutQTotalPoint}
       )
    </insert>

    <select id="selectHockeyStat"  resultType="HashMap">
    SELECT LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY, A_TEAM, A_TEAM_TOTAL_POINT, B_TEAM_TOTAL_POINT, B_TEAM, B_TEAM_REST_DAY, HANDI_CAP, HANDI_CAP_RESULT, ODD, POINT_LINE, POINT_LINE_RESULT, A_TEAM_FIRSTQ_POINT, B_TEAM_FIRSTQ_POINT, FIRSTQ_HANDI_CAP, FIRSTQ_HANDI_CAP_RESULT, FIRSTQ_POINT_LINE, FIRSTQ_POINT_LINE_RESULT, FIRST_POINT, FIRSTQ_POINT, SECONDQ_POINT, THIRDQ_POINT, EXTENDQ_POINT, SHOTOUTQ_POINT, FIRSTQ_TOTAL_POINT, SECONDQ_TOTAL_POINT, THIRDQ_TOTAL_POINT, EXTENDQ_TOTAL_POINT, SHOTOUTQ_TOTAL_POINT
        FROM sport.hockey_data
    ORDER BY MATCH_DATE,GAME_ID;
    </select>

    <insert id="insertSoccerStat" parameterType="blog.model.SoccerModel">

        INSERT INTO sport.soccer_data(
        GAME_ID,
        LEAGUE,
        GROUND,
        MATCH_DATE,
        DAY_OF_WEEK,
        MATCH_TIME,
        A_TEAM,
        A_TEAM_TOTAL_POINT,
        B_TEAM_TOTAL_POINT,
        B_TEAM, HANDI_CAP,
        HANDI_CAP_RESULT,
        POINT_LINE,
        POINT_LINE_RESULT,
        A_TEAM_FIRSTQ_POINT,
        B_TEAM_FIRSTQ_POINT,
        FIRSTQ_HANDI_CAP,
        FIRSTQ_HANDI_CAP_RESULT,
        FIRSTQ_POINT_LINE,
        FIRSTQ_POINT_LINE_RESULT,
        FIRSTQ_POINT,
        SECONDQ_POINT,
        THIRDQ_POINT,
        FOURTHQ_POINT,
        EXTENDQ_POINT,
        FIRSTQ_TOTAL_POINT,
        SECONDQ_TOTAL_POINT,
        THIRDQ_TOTAL_POINT,
        FOURTHQ_TOTAL_POINT,
        EXTENDQ_TOTAL_POINT)
VALUES (
                 #{gameId},
                #{league},
                #{ground},
                #{date},
                #{dayOfWeek},
                #{time},
                #{aTeam},
                #{aTeamTotalPoint},
                #{bTeamTotalPoint},
                #{bTeam},
                #{handiCap},
                #{handiCapResult},
                #{pointLine},
                #{pointLineResult},
                #{aTeamFirstQPoint},
                #{bTeamFirstQPoint},
                #{firstQHandiCap},
                #{firstQHandiCapResult},
                #{firstQPointLine},
                #{firstQPointLineResult},
                #{FirstQPoint},
                #{SecondQPoint},
                #{ThirdQPoint},
                #{FourthQPoint},
                #{ExtendQPoint},
                #{firstQTotalPoint},
                #{secondQTotalPoint},
                #{thirdQTotalPoint},
                #{fourthQTotalPoint},
                #{extendQTotalPoint}
       )
    </insert>

    <insert id="insertSoccerMatch" parameterType="blog.model.SoccerModel">
        INSERT INTO sport.soccer_data(GAME_ID, LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY,  A_TEAM, B_TEAM, B_TEAM_REST_DAY)
      VALUES (
                #{gameId},
                #{league},
                #{ground},
                #{date},
                #{dayOfWeek},
                #{time},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.soccer_data A WHERE A_TEAM = #{aTeam} ORDER BY idx DESC LIMIT 1))) -1,0),
                #{aTeam},
                #{bTeam},
                IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM  sport.soccer_data B WHERE B_TEAM = #{bTeam} ORDER BY idx DESC LIMIT 1))) -1,0)
            )
    </insert>

    <update id="updateSoccerStat" parameterType="blog.model.SoccerModel" >
        UPDATE sport.soccer_data
        SET
                A_TEAM_TOTAL_POINT          =       #{aTeamTotalPoint},
                B_TEAM_TOTAL_POINT          =       #{bTeamTotalPoint},
                HANDI_CAP           =       #{handiCap},
                HANDI_CAP_RESULT            =       #{handiCapResult},
                ODD                     =       #{odd},
                POINT_LINE          =       #{pointLine},
                POINT_LINE_RESULT           =       #{pointLineResult},
                A_TEAM_FIRSTQ_POINT         =       #{aTeamFirstQPoint},
                B_TEAM_FIRSTQ_POINT         =       #{bTeamFirstQPoint},
                FIRSTQ_HANDI_CAP            =       #{firstQHandiCap},
                FIRSTQ_HANDI_CAP_RESULT         =       #{firstQHandiCapResult},
                FIRSTQ_POINT_LINE           =       #{firstQPointLine},
                FIRSTQ_POINT_LINE_RESULT            =       #{firstQPointLineResult},
                FIRSTQ_POINT            =       #{FirstQPoint},
                SECONDQ_POINT           =       #{SecondQPoint},
                THIRDQ_POINT            =       #{ThirdQPoint},
                FOURTHQ_POINT           =       #{FourthQPoint},
                EXTENDQ_POINT           =       #{ExtendQPoint},
                FIRSTQ_TOTAL_POINT          =       #{firstQTotalPoint},
                SECONDQ_TOTAL_POINT         =       #{secondQTotalPoint},
                THIRDQ_TOTAL_POINT          =       #{thirdQTotalPoint},
                FOURTHQ_TOTAL_POINT         =       #{fourthQTotalPoint},
                EXTENDQ_TOTAL_POINT         =       #{extendQTotalPoint}
        WHERE
                GAME_ID         =        #{gameId}      AND
                LEAGUE          =       #{league}       AND
                GROUND          =       #{ground}       AND
                MATCH_DATE          =       #{date}     AND
                A_TEAM          =       #{aTeam}        AND
                B_TEAM              =     #{bTeam}

    </update>

    <select id="selectSoccerStat"  resultType="HashMap">
    SELECT LEAGUE, GROUND, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY, A_TEAM, A_TEAM_TOTAL_POINT, B_TEAM_TOTAL_POINT, B_TEAM, B_TEAM_REST_DAY, HANDI_CAP, HANDI_CAP_RESULT, ODD, POINT_LINE, POINT_LINE_RESULT, A_TEAM_FIRSTQ_POINT, B_TEAM_FIRSTQ_POINT, FIRSTQ_HANDI_CAP, FIRSTQ_HANDI_CAP_RESULT, FIRSTQ_POINT_LINE, FIRSTQ_POINT_LINE_RESULT, FIRSTQ_POINT, SECONDQ_POINT, THIRDQ_POINT, FOURTHQ_POINT, EXTENDQ_POINT, FIRSTQ_TOTAL_POINT, SECONDQ_TOTAL_POINT, THIRDQ_TOTAL_POINT, FOURTHQ_TOTAL_POINT, EXTENDQ_TOTAL_POINT
        FROM sport.soccer_data
    ORDER BY MATCH_DATE,GAME_ID;
    </select>

    <select id="selectMemberList"  resultType="HashMap">
        SELECT EMAIL
            FROM sport.member
        WHERE END_DATE > NOW();
    </select>

    <insert id="truncateBasketSpecialSummary">
        TRUNCATE sport.basketball_special_summary;
    </insert>

    <insert id="insertBasketSpecialSummary"><![CDATA[
        INSERT INTO sport.basketball_special_summary(LEAGUE, TEAM, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER,RDATE)

        #쿼터별 스페셜 승률

        SELECT A.LEAGUE,A.A_TEAM
        ,ROUND(first_first_point_res/allCnt * 100,1) as   first_first_point_per
        ,ROUND(second_first_point_res/allCnt * 100,1) as second_first_point_per
        ,ROUND(third_first_point_res/allCnt * 100,1) as   third_first_point_per
        ,ROUND(fourth_first_point_res/allCnt * 100,1) as fourth_first_point_per
        ,ROUND(first_first_two_point_res/allCnt * 100,1) as first_first_two_point_per
        ,ROUND(second_first_two_point_res/allCnt * 100,1) as second_first_two_point_per
        ,ROUND(third_first_two_point_res/allCnt * 100,1) as third_first_two_point_per
        ,ROUND(fourth_first_two_point_res/allCnt * 100,1) as fourth_first_two_point_per
        ,ROUND(first_first_free_two_res/allCnt * 100,1) as first_first_free_two_per
        ,ROUND(second_first_free_two_res/allCnt * 100,1) as second_first_free_two_per
        ,ROUND(third_first_free_two_res/allCnt * 100,1) as third_first_free_two_per
        ,ROUND(fourth_first_free_two_res/allCnt * 100,1) as fourth_first_free_two_per
        ,ROUND(first_first_three_point_res/allCnt * 100,1) as first_first_three_point_per
        ,ROUND(second_first_three_point_res/allCnt * 100,1) as second_first_three_point_per
        ,ROUND(third_first_three_point_res/allCnt * 100,1) as third_first_three_point_per
        ,ROUND(fourth_first_three_point_res/allCnt * 100,1) as fourth_first_three_point_per
        ,NOW()
        FROM
        (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
        FROM sport.basketball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) A
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as first_first_point_res
        FROM sport.basketball_data
        WHERE FIRSTQ_FIRST_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) B
        ON A.A_TEAM = B.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as second_first_point_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) C
        ON A.A_TEAM = C.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as third_first_point_res
        FROM sport.basketball_data
        WHERE THIRDQ_FIRST_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) D
        ON A.A_TEAM = D.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_first_point_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) E
        ON A.A_TEAM = E.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as first_first_two_point_res
        FROM sport.basketball_data
        WHERE FIRSTQ_FIRST_TWO_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) B2
        ON A.A_TEAM = B2.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as second_first_two_point_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_TWO_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) C2
        ON A.A_TEAM = C2.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as third_first_two_point_res
        FROM sport.basketball_data
        WHERE THIRDQ_FIRST_TWO_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) D2
        ON A.A_TEAM = D2.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_first_two_point_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_TWO_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) E2
        ON A.A_TEAM = E2.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as first_first_free_two_res
        FROM sport.basketball_data
        WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) B3
        ON A.A_TEAM = B3.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as second_first_free_two_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_FREE_TWO = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) C3
        ON A.A_TEAM = C3.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as third_first_free_two_res
        FROM sport.basketball_data
        WHERE THIRDQ_FIRST_FREE_TWO = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) D3
        ON A.A_TEAM = D3.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_first_free_two_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_FREE_TWO = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) E3
        ON A.A_TEAM = E3.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as first_first_three_point_res
        FROM sport.basketball_data
        WHERE FIRSTQ_FIRST_THREE_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) B4
        ON A.A_TEAM = B4.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as second_first_three_point_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_THREE_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) C4
        ON A.A_TEAM = C4.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as third_first_three_point_res
        FROM sport.basketball_data
        WHERE THIRDQ_FIRST_THREE_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) D4
        ON A.A_TEAM = D4.A_TEAM
        LEFT OUTER JOIN
        (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_first_three_point_res
        FROM sport.basketball_data
        WHERE SECONDQ_FIRST_THREE_POINT = '승리'
        AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        GROUP BY A_TEAM) E4
        ON A.A_TEAM = E4.A_TEAM
        ]]>
    </insert>

    <select id="selectBasketSpecialSummary"  resultType="HashMap">
        SELECT LEAGUE, TEAM, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
        FROM sport.basketball_special_summary;
    </select>

    <insert id="truncateBasketQuarterHandiOverSummary">
        TRUNCATE TABLE sport.basketball_quarter_handi_over_summary;
    </insert>

    <insert id="insertBasketQuarterHandiOverSummary">

        <![CDATA[

        INSERT INTO sport.basketball_quarter_handi_over_summary(LEAGUE, TEAM, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE)
#쿼터별 핸디비율,언오버비율
        SELECT A.LEAGUE,A.A_TEAM
             ,first_handi_win_per
             ,100 - first_handi_win_per as first_handi_lose_per
             ,second_handi_win_per
             ,100 - second_handi_win_per as second_handi_lose_per
             ,third_handi_win_per
             ,100 - third_handi_win_per as third_handi_lose_per
             ,fourth_handi_win_per
             ,100 - fourth_handi_win_per as fourth_handi_lose_per
             ,first_over_per
             ,100 - first_over_per as first_under_per
             ,second_over_per
             ,100 - second_over_per as second_under_per
             ,third_over_per
             ,100 - third_over_per as third_under_per
             ,fourth_over_per
             ,100 - fourth_over_per as fourth_under_per
             ,NOW()
        FROM
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as first_res
                  FROM sport.basketball_data
                  WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) A
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND SECONDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as second_res
                  FROM sport.basketball_data
                  WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) B ON A.A_TEAM = B.A_TEAM
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND THIRDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as third_res
                  FROM sport.basketball_data
                  WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) C ON A.A_TEAM = C.A_TEAM
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_res
                  FROM sport.basketball_data
                  WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) D ON A.A_TEAM = D.A_TEAM
                LEFT OUTER JOIN
            (SELECT A2.LEAGUE,A2.A_TEAM
                  ,first_over_per
                  ,100 - first_over_per as first_handi_under_per
                  ,second_over_per
                  ,100 - second_over_per as second_handi_under_per
                  ,third_over_per
                  ,100 - third_over_per as third_handi_under_per
                  ,fourth_over_per
                  ,100 - fourth_over_per as fourth_handi_under_per
             FROM
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,first_res,ROUND(first_res/allCnt * 100,1) as first_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FIRSTQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as first_res
                       FROM sport.basketball_data
                       WHERE FIRSTQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) A2
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,second_res,ROUND(second_res/allCnt * 100,1) as second_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND SECONDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as second_res
                       FROM sport.basketball_data
                       WHERE SECONDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) B2 ON A2.A_TEAM = B2.A_TEAM
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,third_res,ROUND(third_res/allCnt * 100,1) as third_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND THIRDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as third_res
                       FROM sport.basketball_data
                       WHERE THIRDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) C2 ON A2.A_TEAM = C2.A_TEAM
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FOURTHQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_res
                       FROM sport.basketball_data
                       WHERE FOURTHQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) D2 ON A2.A_TEAM = D2.A_TEAM) A2 ON A.A_TEAM = A2.A_TEAM
        ]]>
    </insert>

    <select id="selectBasketQuarterHandiOverSummary"  resultType="HashMap">
        SELECT  LEAGUE, TEAM, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER
        FROM sport.basketball_quarter_handi_over_summary;
    </select>

    <insert id="truncateBasketSpecialComboSummary">
        TRUNCATE TABLE sport.basketball_special_combo_summary;
    </insert>

    <insert id="insertBasketSpecialComboSummary">

        <![CDATA[

        INSERT INTO sport.basketball_special_combo_summary(LEAGUE, TEAM, FIRST_HANDI_THREE_PER, SECOND_HANDI_THREE_PER, THIRD_HANDI_THREE_PER, FOURTH_HANDI_THREE_PER, FIRST_HANDI_FREE_PER, SECOND_HANDI_FREE_PER, THIRD_HANDI_FREE_PER, FOURTH_HANDI_FREE_PER, FIRST_THREE_FREE_PER, SECOND_THREE_FREE_PER, THIRD_THREE_FREE_PER, FOURTH_THREE_FREE_PER, RDATE)

        SELECT A.LEAGUE,A.A_TEAM
             ,ROUND(first_handi_three_res/allCnt * 100,1) as first_handi_three_per
             ,ROUND(second_handi_three_res/allCnt * 100,1) as second_handi_three_per
             ,ROUND(third_handi_three_res/allCnt * 100,1) as third_handi_three_per
             ,ROUND(fourth_handi_three_res/allCnt * 100,1) as fourth_handi_three_per
             ,ROUND(first_handi_free_res/allCnt * 100,1) as first_handi_free_per
             ,ROUND(second_handi_free_res/allCnt * 100,1) as second_handi_free_per
             ,ROUND(third_handi_free_res/allCnt * 100,1) as third_handi_free_per
             ,ROUND(fourth_handi_free_res/allCnt * 100,1) as fourth_handi_free_per
             ,ROUND(first_three_free_res/allCnt * 100,1) as first_three_free_per
             ,ROUND(second_three_free_res/allCnt * 100,1) as second_three_free_per
             ,ROUND(third_three_free_res/allCnt * 100,1) as third_three_free_per
             ,ROUND(fourth_three_free_res/allCnt * 100,1) as fourth_three_free_per
             ,now()
        FROM
            (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
             FROM sport.basketball_data
             WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) A
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as first_handi_three_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_THREE_POINT = '승리' AND FIRSTQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) B
            ON A.A_TEAM = B.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as second_handi_three_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리' AND SECONDQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) C
            ON A.A_TEAM = C.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as third_handi_three_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_THREE_POINT = '승리' AND THIRDQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) D
            ON A.A_TEAM = D.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_handi_three_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리' AND FOURTHQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) E
            ON A.A_TEAM = E.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as first_handi_free_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_FREE_TWO= '승리' AND FIRSTQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) B2
            ON A.A_TEAM = B2.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as second_handi_free_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO= '승리' AND SECONDQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) C2
            ON A.A_TEAM = C2.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as third_handi_free_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_FREE_TWO= '승리' AND THIRDQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) D2
            ON A.A_TEAM = D2.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_handi_free_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO= '승리' AND FOURTHQ_HANDI_CAP_RESULT IN ('승리' ,'적특')
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) E2
            ON A.A_TEAM = E2.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as first_three_free_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_FREE_TWO= '승리' AND FIRSTQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) B3
            ON A.A_TEAM = B3.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as second_three_free_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO= '승리' AND SECONDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) C3
            ON A.A_TEAM = C3.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as third_three_free_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_FREE_TWO= '승리' AND THIRDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) D3
            ON A.A_TEAM = D3.A_TEAM
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_three_free_res
             FROM sport.basketball_data
             WHERE FOURTHQ_FIRST_FREE_TWO= '승리' AND FOURTHQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM) E3
            ON A.A_TEAM = E3.A_TEAM
        ]]>
    </insert>

    <select id="selectBasketSpecialComboSummary"  resultType="HashMap">
        SELECT LEAGUE, TEAM, FIRST_HANDI_THREE_PER, SECOND_HANDI_THREE_PER, THIRD_HANDI_THREE_PER, FOURTH_HANDI_THREE_PER, FIRST_HANDI_FREE_PER, SECOND_HANDI_FREE_PER, THIRD_HANDI_FREE_PER, FOURTH_HANDI_FREE_PER, FIRST_THREE_FREE_PER, SECOND_THREE_FREE_PER, THIRD_THREE_FREE_PER, FOURTH_THREE_FREE_PER
        FROM sport.basketball_special_combo_summary;
    </select>


    <insert id="truncateBasketQuarterHandiComboSummary">
        TRUNCATE TABLE sport.basketball_quarter_handi_combo_special;
    </insert>

    <insert id="insertBasketQuarterHandiComboSummary">

        <![CDATA[

        INSERT INTO sport.basketball_quarter_handi_combo_special(LEAGUE, TEAM, FIRST_HANDI_WIN_OVER_PER, FIRST_HANDI_WIN_UNDER_PER, SECOND_HANDI_WIN_OVER_PER, SECOND_HANDI_WIN_UNDER_PER, THIRD_HANDI_WIN_OVER_PER, THIRD_HANDI_WIN_UNDER_PER, FOURTH_HANDI_WIN_OVER_PER, FOURTH_HANDI_WIN_UNDER_PER, FIRST_HANDI_LOSE_OVER_PER, FIRST_HANDI_LOSE_UNDER_PER, SECOND_HANDI_LOSE_OVER_PER, SECOND_HANDI_LOSE_UNDER_PER, THIRD_HANDI_LOSE_OVER_PER, THIRD_HANDI_LOSE_UNDER_PER, FOURTH_HANDI_LOSE_OVER_PER, FOURTH_HANDI_LOSE_UNDER_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM
             ,first_handi_win_over_per
             ,first_handi_win_under_per
             ,second_handi_win_over_per
             ,second_handi_win_under_per
             ,third_handi_win_over_per
             ,third_handi_win_under_per
             ,fourth_handi_win_over_per
             ,fourth_handi_win_under_per
             ,first_handi_lose_over_per
             ,first_handi_lose_under_per
             ,second_handi_lose_over_per
             ,second_handi_lose_under_per
             ,third_handi_lose_over_per
             ,third_handi_lose_under_per
             ,fourth_handi_lose_over_per
             ,fourth_handi_lose_under_per
             ,NOW()
        FROM
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_win_over_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as first_res
                  FROM sport.basketball_data
                  WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                    AND FIRSTQ_POINT_LINE_RESULT IN('오버','적특')
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) A
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_win_over_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND SECONDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as second_res
                  FROM sport.basketball_data
                  WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                    AND SECONDQ_POINT_LINE_RESULT IN('오버','적특')
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) B ON A.A_TEAM = B.A_TEAM
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_win_over_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND THIRDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as third_res
                  FROM sport.basketball_data
                  WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                    AND THIRDQ_POINT_LINE_RESULT IN('오버','적특')
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) C ON A.A_TEAM = C.A_TEAM
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,allCnt
                  ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_win_over_per
             FROM
                 (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_res
                  FROM sport.basketball_data
                  WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                    AND FOURTHQ_POINT_LINE_RESULT IN('오버','적특')
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM) B
                 ON A.A_TEAM = B.A_TEAM) D ON A.A_TEAM = D.A_TEAM
                LEFT OUTER JOIN
            (SELECT A2.LEAGUE,A2.A_TEAM
                  ,first_handi_lose_over_per
                  ,second_handi_lose_over_per
                  ,third_handi_lose_over_per
                  ,fourth_handi_lose_over_per
             FROM
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_lose_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as first_res
                       FROM sport.basketball_data
                       WHERE FIRSTQ_HANDI_CAP_RESULT = '패배'
                         AND FIRSTQ_POINT_LINE_RESULT IN('오버','적특')
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) A2
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_lose_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND SECONDQ_HANDI_CAP_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as second_res
                       FROM sport.basketball_data
                       WHERE SECONDQ_HANDI_CAP_RESULT = '패배'
                         AND  SECONDQ_POINT_LINE_RESULT IN('오버','적특')
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) B2 ON A2.A_TEAM = B2.A_TEAM
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_lose_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND THIRDQ_HANDI_CAP_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as third_res
                       FROM sport.basketball_data
                       WHERE THIRDQ_HANDI_CAP_RESULT = '패배'
                         AND  THIRDQ_POINT_LINE_RESULT IN('오버','적특')
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) C2 ON A2.A_TEAM = C2.A_TEAM
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,allCnt
                       ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_lose_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                       GROUP BY A_TEAM) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_res
                       FROM sport.basketball_data
                       WHERE FOURTHQ_HANDI_CAP_RESULT = '패배'
                         AND  FOURTHQ_POINT_LINE_RESULT IN('오버','적특')
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM) B
                      ON A.A_TEAM = B.A_TEAM) D2 ON A2.A_TEAM = D2.A_TEAM) A2 ON A.A_TEAM = A2.A_TEAM
                LEFT OUTER JOIN
            ( SELECT A.*
                   ,second_handi_win_under_per
                   ,third_handi_win_under_per
                   ,fourth_handi_win_under_per
                   ,first_handi_lose_under_per
                   ,second_handi_lose_under_per
                   ,third_handi_lose_under_per
                   ,fourth_handi_lose_under_per
              FROM
                  (SELECT A.LEAGUE,A.A_TEAM,allCnt
                        ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_win_under_per
                   FROM
                       (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                        FROM sport.basketball_data
                        WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                          AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                        GROUP BY A_TEAM) A
                           LEFT OUTER JOIN
                       (SELECT LEAGUE, A_TEAM,COUNT(1) as first_res
                        FROM sport.basketball_data
                        WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                          AND FIRSTQ_POINT_LINE_RESULT IN('언더','적특')
                          AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        GROUP BY A_TEAM) B
                       ON A.A_TEAM = B.A_TEAM) A
                      LEFT OUTER JOIN
                  (SELECT A.LEAGUE,A.A_TEAM,allCnt
                        ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_win_under_per
                   FROM
                       (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                        FROM sport.basketball_data
                        WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                          AND SECONDQ_HANDI_CAP_RESULT != '적특'
                        GROUP BY A_TEAM) A
                           LEFT OUTER JOIN
                       (SELECT LEAGUE, A_TEAM,COUNT(1) as second_res
                        FROM sport.basketball_data
                        WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                          AND SECONDQ_POINT_LINE_RESULT IN('언더','적특')
                          AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        GROUP BY A_TEAM) B
                       ON A.A_TEAM = B.A_TEAM) B ON A.A_TEAM = B.A_TEAM
                      LEFT OUTER JOIN
                  (SELECT A.LEAGUE,A.A_TEAM,allCnt
                        ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_win_under_per
                   FROM
                       (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                        FROM sport.basketball_data
                        WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                          AND THIRDQ_HANDI_CAP_RESULT != '적특'
                        GROUP BY A_TEAM) A
                           LEFT OUTER JOIN
                       (SELECT LEAGUE, A_TEAM,COUNT(1) as third_res
                        FROM sport.basketball_data
                        WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                          AND THIRDQ_POINT_LINE_RESULT IN('언더','적특')
                          AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        GROUP BY A_TEAM) B
                       ON A.A_TEAM = B.A_TEAM) C ON A.A_TEAM = C.A_TEAM
                      LEFT OUTER JOIN
                  (SELECT A.LEAGUE,A.A_TEAM,allCnt
                        ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_win_under_per
                   FROM
                       (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                        FROM sport.basketball_data
                        WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                          AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                        GROUP BY A_TEAM) A
                           LEFT OUTER JOIN
                       (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_res
                        FROM sport.basketball_data
                        WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                          AND FOURTHQ_POINT_LINE_RESULT IN('언더','적특')
                          AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        GROUP BY A_TEAM) B
                       ON A.A_TEAM = B.A_TEAM) D ON A.A_TEAM = D.A_TEAM
                      LEFT OUTER JOIN
                  (SELECT A2.LEAGUE,A2.A_TEAM
                        ,first_handi_lose_under_per
                        ,second_handi_lose_under_per
                        ,third_handi_lose_under_per
                        ,fourth_handi_lose_under_per
                   FROM
                       (SELECT A.LEAGUE,A.A_TEAM,allCnt
                             ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_lose_under_per
                        FROM
                            (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                             FROM sport.basketball_data
                             WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                               AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                             GROUP BY A_TEAM) A
                                LEFT OUTER JOIN
                            (SELECT LEAGUE, A_TEAM,COUNT(1) as first_res
                             FROM sport.basketball_data
                             WHERE FIRSTQ_HANDI_CAP_RESULT = '패배'
                               AND FIRSTQ_POINT_LINE_RESULT IN('언더','적특')
                               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                             GROUP BY A_TEAM) B
                            ON A.A_TEAM = B.A_TEAM) A2
                           LEFT OUTER JOIN
                       (SELECT A.LEAGUE,A.A_TEAM,allCnt
                             ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_lose_under_per
                        FROM
                            (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                             FROM sport.basketball_data
                             WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                               AND SECONDQ_HANDI_CAP_RESULT != '적특'
                             GROUP BY A_TEAM) A
                                LEFT OUTER JOIN
                            (SELECT LEAGUE, A_TEAM,COUNT(1) as second_res
                             FROM sport.basketball_data
                             WHERE SECONDQ_HANDI_CAP_RESULT = '패배'
                               AND  SECONDQ_POINT_LINE_RESULT IN('언더','적특')
                               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                             GROUP BY A_TEAM) B
                            ON A.A_TEAM = B.A_TEAM) B2 ON A2.A_TEAM = B2.A_TEAM
                           LEFT OUTER JOIN
                       (SELECT A.LEAGUE,A.A_TEAM,allCnt
                             ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_lose_under_per
                        FROM
                            (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                             FROM sport.basketball_data
                             WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                               AND THIRDQ_HANDI_CAP_RESULT != '적특'
                             GROUP BY A_TEAM) A
                                LEFT OUTER JOIN
                            (SELECT LEAGUE, A_TEAM,COUNT(1) as third_res
                             FROM sport.basketball_data
                             WHERE THIRDQ_HANDI_CAP_RESULT = '패배'
                               AND  THIRDQ_POINT_LINE_RESULT IN('언더','적특')
                               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                             GROUP BY A_TEAM) B
                            ON A.A_TEAM = B.A_TEAM) C2 ON A2.A_TEAM = C2.A_TEAM
                           LEFT OUTER JOIN
                       (SELECT A.LEAGUE,A.A_TEAM,allCnt
                             ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_lose_under_per
                        FROM
                            (SELECT LEAGUE,A_TEAM,COUNT(1) as allCnt
                             FROM sport.basketball_data
                             WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                               AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                             GROUP BY A_TEAM) A
                                LEFT OUTER JOIN
                            (SELECT LEAGUE, A_TEAM,COUNT(1) as fourth_res
                             FROM sport.basketball_data
                             WHERE FOURTHQ_HANDI_CAP_RESULT = '패배'
                               AND  FOURTHQ_POINT_LINE_RESULT IN('언더','적특')
                               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                             GROUP BY A_TEAM) B
                            ON A.A_TEAM = B.A_TEAM) D2 ON A2.A_TEAM = D2.A_TEAM ) A2 ON A.A_TEAM = A2.A_TEAM)  A3 ON A.A_TEAM = A3.A_TEAM

        ]]>
    </insert>

    <select id="selectBasketQuarterHandiComboSummary"  resultType="HashMap">
        SELECT LEAGUE, TEAM, FIRST_HANDI_WIN_OVER_PER, FIRST_HANDI_WIN_UNDER_PER, SECOND_HANDI_WIN_OVER_PER, SECOND_HANDI_WIN_UNDER_PER, THIRD_HANDI_WIN_OVER_PER, THIRD_HANDI_WIN_UNDER_PER, FOURTH_HANDI_WIN_OVER_PER, FOURTH_HANDI_WIN_UNDER_PER, FIRST_HANDI_LOSE_OVER_PER, FIRST_HANDI_LOSE_UNDER_PER, SECOND_HANDI_LOSE_OVER_PER, SECOND_HANDI_LOSE_UNDER_PER, THIRD_HANDI_LOSE_OVER_PER, THIRD_HANDI_LOSE_UNDER_PER, FOURTH_HANDI_LOSE_OVER_PER, FOURTH_HANDI_LOSE_UNDER_PER
        FROM sport.basketball_quarter_handi_combo_special;
    </select>

    <insert id="truncateBasketQuarterHandiOverGroundSummary">
        TRUNCATE TABLE sport.basketball_quarter_handi_over_ground_summary;
    </insert>

    <insert id="truncateBasketSpecialGroundSummary">
        TRUNCATE TABLE sport.basketball_special_ground_summary;
    </insert>

    <insert id="insertBasketSpecialGroundSummary">
        <![CDATA[
        INSERT INTO sport.basketball_special_ground_summary(LEAGUE, TEAM, GROUND, FIRST_FIRST_POINT_PER,
                                                            SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER,
                                                            FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER,
                                                            SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER,
                                                            FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER,
                                                            SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER,
                                                            FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER,
                                                            SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER,
                                                            FOURTH_FIRST_THREE_POINT_PER, RDATE)

        SELECT A.LEAGUE
             , A.A_TEAM
             , A.GROUND
             , ROUND(first_first_point_res / allCnt * 100, 1)        as first_first_point_per
             , ROUND(second_first_point_res / allCnt * 100, 1)       as second_first_point_per
             , ROUND(third_first_point_res / allCnt * 100, 1)        as third_first_point_per
             , ROUND(fourth_first_point_res / allCnt * 100, 1)       as fourth_first_point_per
             , ROUND(first_first_two_point_res / allCnt * 100, 1)    as first_first_two_point_per
             , ROUND(second_first_two_point_res / allCnt * 100, 1)   as second_first_two_point_per
             , ROUND(third_first_two_point_res / allCnt * 100, 1)    as third_first_two_point_per
             , ROUND(fourth_first_two_point_res / allCnt * 100, 1)   as fourth_first_two_point_per
             , ROUND(first_first_free_two_res / allCnt * 100, 1)     as first_first_free_two_per
             , ROUND(second_first_free_two_res / allCnt * 100, 1)    as second_first_free_two_per
             , ROUND(third_first_free_two_res / allCnt * 100, 1)     as third_first_free_two_per
             , ROUND(fourth_first_free_two_res / allCnt * 100, 1)    as fourth_first_free_two_per
             , ROUND(first_first_three_point_res / allCnt * 100, 1)  as first_first_three_point_per
             , ROUND(second_first_three_point_res / allCnt * 100, 1) as second_first_three_point_per
             , ROUND(third_first_three_point_res / allCnt * 100, 1)  as third_first_three_point_per
             , ROUND(fourth_first_three_point_res / allCnt * 100, 1) as fourth_first_three_point_per
             , NOW()
        FROM (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as allCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) A
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as first_first_point_res
              FROM sport.basketball_data
              WHERE FIRSTQ_FIRST_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) B
             ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as second_first_point_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) C
             ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as third_first_point_res
              FROM sport.basketball_data
              WHERE THIRDQ_FIRST_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) D
             ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as fourth_first_point_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) E
             ON A.A_TEAM = E.A_TEAM AND A.GROUND = E.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as first_first_two_point_res
              FROM sport.basketball_data
              WHERE FIRSTQ_FIRST_TWO_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) B2
             ON A.A_TEAM = B2.A_TEAM AND A.GROUND = B2.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as second_first_two_point_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_TWO_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) C2
             ON A.A_TEAM = C2.A_TEAM AND A.GROUND = C2.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as third_first_two_point_res
              FROM sport.basketball_data
              WHERE THIRDQ_FIRST_TWO_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) D2
             ON A.A_TEAM = D2.A_TEAM AND A.GROUND = D2.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as fourth_first_two_point_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_TWO_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) E2
             ON A.A_TEAM = E2.A_TEAM AND A.GROUND = E2.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as first_first_free_two_res
              FROM sport.basketball_data
              WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) B3
             ON A.A_TEAM = B3.A_TEAM AND A.GROUND = B3.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as second_first_free_two_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_FREE_TWO = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) C3
             ON A.A_TEAM = C3.A_TEAM AND A.GROUND = C3.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as third_first_free_two_res
              FROM sport.basketball_data
              WHERE THIRDQ_FIRST_FREE_TWO = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) D3
             ON A.A_TEAM = D3.A_TEAM AND A.GROUND = D3.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as fourth_first_free_two_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_FREE_TWO = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) E3
             ON A.A_TEAM = E3.A_TEAM AND A.GROUND = E3.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as first_first_three_point_res
              FROM sport.basketball_data
              WHERE FIRSTQ_FIRST_THREE_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) B4
             ON A.A_TEAM = B4.A_TEAM AND A.GROUND = B4.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as second_first_three_point_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_THREE_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) C4
             ON A.A_TEAM = C4.A_TEAM AND A.GROUND = C4.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as third_first_three_point_res
              FROM sport.basketball_data
              WHERE THIRDQ_FIRST_THREE_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) D4
             ON A.A_TEAM = D4.A_TEAM AND A.GROUND = D4.GROUND
                 LEFT OUTER JOIN
             (SELECT LEAGUE, A_TEAM, GROUND, COUNT(1) as fourth_first_three_point_res
              FROM sport.basketball_data
              WHERE SECONDQ_FIRST_THREE_POINT = '승리'
                AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY)
              GROUP BY A_TEAM, GROUND) E4
             ON A.A_TEAM = E4.A_TEAM AND A.GROUND = E4.GROUND
        ]]>
    </insert>

    <insert id="insertBasketQuarterHandiOverGroundSummary">
        <![CDATA[
        INSERT INTO sport.basketball_quarter_handi_over_ground_summary(LEAGUE, TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE)

        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
             ,first_handi_win_per
             ,100 - first_handi_win_per as first_handi_lose_per
             ,second_handi_win_per
             ,100 - second_handi_win_per as second_handi_lose_per
             ,third_handi_win_per
             ,100 - third_handi_win_per as third_handi_lose_per
             ,fourth_handi_win_per
             ,100 - fourth_handi_win_per as fourth_handi_lose_per
             ,first_over_per
             ,100 - first_over_per as first_under_per
             ,second_over_per
             ,100 - second_over_per as second_under_per
             ,third_over_per
             ,100 - third_over_per as third_under_per
             ,fourth_over_per
             ,100 - fourth_over_per as fourth_under_per
             ,NOW()
        FROM
            (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                  ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,GROUND) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as first_res
                  FROM sport.basketball_data
                  WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,GROUND) B
                 ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) A
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                  ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND SECONDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,GROUND) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as second_res
                  FROM sport.basketball_data
                  WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,GROUND) B
                 ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                  ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND THIRDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,GROUND) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as third_res
                  FROM sport.basketball_data
                  WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,GROUND) B
                 ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) C ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                  ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,GROUND) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as fourth_res
                  FROM sport.basketball_data
                  WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,GROUND) B
                 ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) D ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND
                LEFT OUTER JOIN
            (SELECT A2.LEAGUE,A2.A_TEAM,A2.GROUND
                  ,first_over_per
                  ,100 - first_over_per as first_handi_under_per
                  ,second_over_per
                  ,100 - second_over_per as second_handi_under_per
                  ,third_over_per
                  ,100 - third_over_per as third_handi_under_per
                  ,fourth_over_per
                  ,100 - fourth_over_per as fourth_handi_under_per
             FROM
                 (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                       ,first_res,ROUND(first_res/allCnt * 100,1) as first_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FIRSTQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,GROUND) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as first_res
                       FROM sport.basketball_data
                       WHERE FIRSTQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,GROUND) B
                      ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) A2
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                       ,second_res,ROUND(second_res/allCnt * 100,1) as second_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND SECONDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,GROUND) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as second_res
                       FROM sport.basketball_data
                       WHERE SECONDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,GROUND) B
                      ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) B2 ON A2.A_TEAM = B2.A_TEAM AND A2.GROUND = B2.GROUND
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                       ,third_res,ROUND(third_res/allCnt * 100,1) as third_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND THIRDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,GROUND) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as third_res
                       FROM sport.basketball_data
                       WHERE THIRDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,GROUND) B
                      ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) C2 ON A2.A_TEAM = C2.A_TEAM AND A2.GROUND = C2.GROUND
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.GROUND,allCnt
                       ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,GROUND,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FOURTHQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,GROUND) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,GROUND,COUNT(1) as fourth_res
                       FROM sport.basketball_data
                       WHERE FOURTHQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,GROUND) B
                      ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND) D2 ON A2.A_TEAM = D2.A_TEAM AND A2.GROUND = D2.GROUND) A2 ON A.A_TEAM = A2.A_TEAM AND A.GROUND = A2.GROUND;

        ]]>
        </insert>

    <select id="selectBasketSpecialGroundSummary"  resultType="HashMap">
        SELECT LEAGUE, TEAM, GROUND, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER, RDATE
        FROM sport.basketball_special_ground_summary
        ORDER BY GROUND DESC;
    </select>

    <select id="selectBasketQuarterHandiOverGroundSummary"  resultType="HashMap">
        SELECT LEAGUE, TEAM, GROUND, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
        FROM sport.basketball_quarter_handi_over_ground_summary
        ORDER BY GROUND DESC;
    </select>

    <insert id="truncateBasketHandiOverSummary">
        TRUNCATE TABLE sport.basketball_handi_over_summary;
    </insert>

    <insert id="insertBasketHandiOverSummary">
        <![CDATA[
        INSERT INTO sport.basketball_handi_over_summary (LEAGUE, TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM
             ,ROUND(winCnt/allHandiCnt * 100,1) as winPer
             ,100 - ROUND(winCnt/allHandiCnt * 100,1) as losePer
             ,ROUND(overCnt/allPointCnt * 100,1) as overPer
             ,100 - ROUND(overCnt/allPointCnt * 100,1) as underPer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,COUNT(1) allHandiCnt
                 FROM sport.basketball_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,COUNT(1) winCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM
             )B ON A.A_TEAM = B.A_TEAM
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,COUNT(1) allPointCnt
               FROM sport.basketball_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
               GROUP BY A_TEAM
             ) C ON A.A_TEAM = C.A_TEAM
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,COUNT(1) overCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM
             )D ON A.A_TEAM = D.A_TEAM;
        ]]>
    </insert>

    <select id="selectBasketHandiOverSummary" resultType="HashMap">
        SELECT LEAGUE, TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
            FROM sport.basketball_handi_over_summary;
    </select>

    <insert id="truncateBasketHandiOverGroundSummary">
        TRUNCATE TABLE sport.basketball_handi_over_ground_summary;
    </insert>

    <insert id="insertBasketHandiOverGroundSummary">
        <![CDATA[

        INSERT INTO sport.basketball_handi_over_ground_summary (LEAGUE, TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
             ,ROUND(winCnt/allHandiCnt * 100,1) as winPer
             ,100 - ROUND(winCnt/allHandiCnt * 100,1) as losePer
             ,ROUND(overCnt/allPointCnt * 100,1) as overPer
             ,100 - ROUND(overCnt/allPointCnt * 100,1) as underPer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allHandiCnt
                 FROM sport.basketball_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM,GROUND
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) winCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,GROUND
             )B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allPointCnt
               FROM sport.basketball_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
               GROUP BY A_TEAM,GROUND
             ) C ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) overCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,GROUND
             )D ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND;

        ]]>
    </insert>

    <select id="selectBasketHandiOverGroundSummary" resultType="HashMap">
        SELECT LEAGUE, TEAM,GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
        FROM sport.basketball_handi_over_ground_summary
        ORDER BY GROUND DESC;
    </select>

    <select id="selectAllSummary" resultType="HashMap">
        <![CDATA[
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
            CASE A.GROUND WHEN '홈' THEN 1
                          ELSE 2
                END AS PRO
             ,  HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
             ,  FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
             ,  FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM
                 FROM sport.basketball_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
               FROM sport.basketball_handi_over_summary
             ) B ON A.A_TEAM = B.TEAM
                 INNER JOIN
             (SELECT TEAM,GROUND, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
              FROM sport.basketball_special_summary
             ) C ON A.A_TEAM = C.TEAM
                 INNER JOIN
             (SELECT  TEAM,GROUND, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
              FROM sport.basketball_quarter_handi_over_summary) D ON A.A_TEAM = D.TEAM
        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
            CASE A.GROUND WHEN '홈' THEN 3
                          ELSE 4
                END AS PRO
             ,  HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
             ,  FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
             ,  FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM
                 FROM sport.basketball_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
               FROM sport.basketball_handi_over_ground_summary
             ) B ON A.A_TEAM = B.TEAM AND A.GROUND = B.GROUND
                 INNER JOIN
             (SELECT TEAM,GROUND, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
              FROM sport.basketball_special_ground_summary
             ) C ON A.A_TEAM = C.TEAM AND A.GROUND = C.GROUND
                 INNER JOIN
             (SELECT  TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
              FROM sport.basketball_quarter_handi_over_ground_summary) D ON A.A_TEAM = D.TEAM AND A.GROUND = D.GROUND
        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
            CASE A.GROUND WHEN '홈' THEN 5
                          ELSE 6
                END AS PRO
             ,  HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
             ,  FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
             ,  FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM,ODD
                 FROM sport.basketball_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
               FROM sport.basketball_handi_over_odd_summary
             ) B ON A.A_TEAM = B.TEAM AND A.ODD = B.GROUND
                 INNER JOIN
             (SELECT TEAM,GROUND, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
              FROM sport.basketball_special_odd_summary
             ) C ON A.A_TEAM = C.TEAM AND A.ODD = C.GROUND
                 INNER JOIN
             (SELECT  TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
              FROM sport.basketball_quarter_handi_over_odd_summary) D ON A.A_TEAM = D.TEAM AND A.ODD = D.GROUND
        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
            CASE A.GROUND WHEN '홈' THEN 7
                          ELSE 8
                END AS PRO
             ,  HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
             ,  FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
             ,  FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM,A_TEAM_REST_DAY
                 FROM sport.basketball_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
               FROM sport.basketball_handi_over_rest_summary
             ) B ON A.A_TEAM = B.TEAM AND A.A_TEAM_REST_DAY = B.GROUND
                 INNER JOIN
             (SELECT TEAM,GROUND, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
              FROM sport.basketball_special_rest_summary
             ) C ON A.A_TEAM = C.TEAM AND A.A_TEAM_REST_DAY = C.GROUND
                 INNER JOIN
             (SELECT  TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
              FROM sport.basketball_quarter_handi_over_rest_summary) D ON A.A_TEAM = D.TEAM AND A.A_TEAM_REST_DAY = D.GROUND
        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
            CASE A.GROUND WHEN '홈' THEN 9
                          ELSE 10
                END AS PRO
             ,  HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
             ,  FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
             ,  FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM,DAY_OF_WEEK
                 FROM sport.basketball_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
               FROM sport.basketball_handi_over_week_summary
             ) B ON A.A_TEAM = B.TEAM AND A.DAY_OF_WEEK = B.GROUND
                 INNER JOIN
             (SELECT TEAM,GROUND, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
              FROM sport.basketball_special_week_summary
             ) C ON A.A_TEAM = C.TEAM AND A.DAY_OF_WEEK = C.GROUND
                 INNER JOIN
             (SELECT  TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
              FROM sport.basketball_quarter_handi_over_week_summary) D ON A.A_TEAM = D.TEAM AND A.DAY_OF_WEEK = D.GROUND
        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,null ,null,null,
            CASE A.GROUND WHEN '홈' THEN 0
                          ELSE 0
                END AS PRO
             ,  null, null, null, null
             ,  null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null
             ,  null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, RDATE
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM
                 FROM sport.basketball_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
               FROM sport.basketball_handi_over_summary
             ) B ON A.A_TEAM = B.TEAM
                 INNER JOIN
             (SELECT TEAM,GROUND, FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER
              FROM sport.basketball_special_summary
             ) C ON A.A_TEAM = C.TEAM
                 INNER JOIN
             (SELECT  TEAM,GROUND, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE
              FROM sport.basketball_quarter_handi_over_summary) D ON A.A_TEAM = D.TEAM
        WHERE A.GROUND = '홈'

        ORDER BY MATCH_TIME,GAME_ID DESC , PRO   ;

        ]]>
    </select>



    <insert id="truncateBasketSpecialOddSummary">
        TRUNCATE TABLE sport.basketball_special_odd_summary;
    </insert>

    <insert id="truncateBasketQuarterHandiOverOddSummary">
        TRUNCATE TABLE sport.basketball_quarter_handi_over_odd_summary;
    </insert>

    <insert id="truncateBasketHandiOverOddSummary">
        TRUNCATE TABLE sport.basketball_handi_over_odd_summary;
    </insert>

    <insert id="insertBasketSpecialOddSummary">
        <![CDATA[
        INSERT INTO sport.basketball_special_odd_summary(LEAGUE, TEAM, GROUND ,FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER,RDATE)

        SELECT A.LEAGUE,A.A_TEAM,A.ODD as GROUND
             ,IFNULL(ROUND(first_first_point_res/allCnt * 100,1),0) as   first_first_point_per
             ,IFNULL(ROUND(second_first_point_res/allCnt * 100,1),0) as second_first_point_per
             ,IFNULL(ROUND(third_first_point_res/allCnt * 100,1),0) as   third_first_point_per
             ,IFNULL(ROUND(fourth_first_point_res/allCnt * 100,1),0) as fourth_first_point_per
             ,IFNULL(ROUND(first_first_two_point_res/allCnt * 100,1),0) as first_first_two_point_per
             ,IFNULL(ROUND(second_first_two_point_res/allCnt * 100,1),0) as second_first_two_point_per
             ,IFNULL(ROUND(third_first_two_point_res/allCnt * 100,1),0) as third_first_two_point_per
             ,IFNULL(ROUND(fourth_first_two_point_res/allCnt * 100,1),0) as fourth_first_two_point_per
             ,IFNULL(ROUND(first_first_free_two_res/allCnt * 100,1),0) as first_first_free_two_per
             ,IFNULL(ROUND(second_first_free_two_res/allCnt * 100,1),0) as second_first_free_two_per
             ,IFNULL(ROUND(third_first_free_two_res/allCnt * 100,1),0) as third_first_free_two_per
             ,IFNULL(ROUND(fourth_first_free_two_res/allCnt * 100,1),0) as fourth_first_free_two_per
             ,IFNULL(ROUND(first_first_three_point_res/allCnt * 100,1),0) as first_first_three_point_per
             ,IFNULL(ROUND(second_first_three_point_res/allCnt * 100,1),0) as second_first_three_point_per
             ,IFNULL(ROUND(third_first_three_point_res/allCnt * 100,1),0) as third_first_three_point_per
             ,IFNULL(ROUND(fourth_first_three_point_res/allCnt * 100,1),0) as fourth_first_three_point_per
             ,NOW()
        FROM
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as allCnt
             FROM sport.basketball_data
             WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) A
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as first_first_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) B
            ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as second_first_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) C
            ON A.A_TEAM = C.A_TEAM AND A.ODD = C.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as third_first_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) D
            ON A.A_TEAM = D.A_TEAM  AND A.ODD = D.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as fourth_first_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) E
            ON A.A_TEAM = E.A_TEAM AND A.ODD = E.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as first_first_two_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) B2
            ON A.A_TEAM = B2.A_TEAM  AND A.ODD = B2.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as second_first_two_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) C2
            ON A.A_TEAM = C2.A_TEAM  AND A.ODD = C2.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as third_first_two_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) D2
            ON A.A_TEAM = D2.A_TEAM AND A.ODD = D2.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as fourth_first_two_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) E2
            ON A.A_TEAM = E2.A_TEAM AND A.ODD = E2.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as first_first_free_two_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) B3
            ON A.A_TEAM = B3.A_TEAM AND A.ODD = B3.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as second_first_free_two_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) C3
            ON A.A_TEAM = C3.A_TEAM AND A.ODD = C3.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as third_first_free_two_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) D3
            ON A.A_TEAM = D3.A_TEAM AND A.ODD = D3.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as fourth_first_free_two_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) E3
            ON A.A_TEAM = E3.A_TEAM AND A.ODD = E3.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as first_first_three_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) B4
            ON A.A_TEAM = B4.A_TEAM AND A.ODD = B4.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as second_first_three_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) C4
            ON A.A_TEAM = C4.A_TEAM AND A.ODD = C4.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as third_first_three_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) D4
            ON A.A_TEAM = D4.A_TEAM AND A.ODD = D4.ODD
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as fourth_first_three_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,ODD) E4
            ON A.A_TEAM = E4.A_TEAM AND A.ODD = E4.ODD
        WHERE allCnt != 0 AND A.ODD != '없음';

        ]]>
    </insert>

    <insert id="insertBasketQuarterHandiOverOddSummary">
        <![CDATA[
        INSERT INTO sport.basketball_quarter_handi_over_odd_summary(LEAGUE, TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE)

        SELECT A.LEAGUE,A.A_TEAM,A.ODD as GROUND
             ,IFNULL(first_handi_win_per,0)
             ,100 - IFNULL(first_handi_win_per,0) as first_handi_lose_per
             ,IFNULL(second_handi_win_per,0)
             ,100 - IFNULL(second_handi_win_per,0) as second_handi_lose_per
             , IFNULL(third_handi_win_per,0)
             ,100 -  IFNULL(third_handi_win_per,0) as third_handi_lose_per
             , IFNULL(fourth_handi_win_per,0)
             ,100 -  IFNULL(fourth_handi_win_per,0) as fourth_handi_lose_per
             , IFNULL(first_over_per,0)
             ,100 -  IFNULL(first_over_per,0) as first_under_per
             , IFNULL(second_over_per,0)
             ,100 -  IFNULL(second_over_per,0) as second_under_per
             , IFNULL(third_over_per,0)
             ,100 -  IFNULL(third_over_per,0) as third_under_per
             , IFNULL(fourth_over_per,0)
             ,100 -  IFNULL(fourth_over_per,0) as fourth_under_per
             ,NOW()
        FROM
            (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                  ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,ODD ) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as first_res
                  FROM sport.basketball_data
                  WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,ODD) B
                 ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) A
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                  ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND SECONDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,ODD) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as second_res
                  FROM sport.basketball_data
                  WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,ODD) B
                 ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) B ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                  ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND THIRDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,ODD) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as third_res
                  FROM sport.basketball_data
                  WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,ODD) B
                 ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) C ON A.A_TEAM = C.A_TEAM AND A.ODD = C.ODD
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                  ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,ODD) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as fourth_res
                  FROM sport.basketball_data
                  WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,ODD) B
                 ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) D ON A.A_TEAM = D.A_TEAM AND A.ODD = D.ODD
                LEFT OUTER JOIN
            (SELECT A2.LEAGUE,A2.A_TEAM,A2.ODD
                  ,first_over_per
                  ,100 - first_over_per as first_handi_under_per
                  ,second_over_per
                  ,100 - second_over_per as second_handi_under_per
                  ,third_over_per
                  ,100 - third_over_per as third_handi_under_per
                  ,fourth_over_per
                  ,100 - fourth_over_per as fourth_handi_under_per
             FROM
                 (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                       ,first_res,ROUND(first_res/allCnt * 100,1) as first_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FIRSTQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,ODD) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as first_res
                       FROM sport.basketball_data
                       WHERE FIRSTQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,ODD) B
                      ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) A2
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                       ,second_res,ROUND(second_res/allCnt * 100,1) as second_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND SECONDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,ODD) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as second_res
                       FROM sport.basketball_data
                       WHERE SECONDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,ODD) B
                      ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) B2 ON A2.A_TEAM = B2.A_TEAM AND A2.ODD = B2.ODD
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                       ,third_res,ROUND(third_res/allCnt * 100,1) as third_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND THIRDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,ODD) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as third_res
                       FROM sport.basketball_data
                       WHERE THIRDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,ODD) B
                      ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) C2 ON A2.A_TEAM = C2.A_TEAM AND A2.ODD = C2.ODD
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.ODD,allCnt
                       ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,ODD,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FOURTHQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,ODD) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,ODD,COUNT(1) as fourth_res
                       FROM sport.basketball_data
                       WHERE FOURTHQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,ODD) B
                      ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD  WHERE allCnt != 0) D2 ON A2.A_TEAM = D2.A_TEAM AND A2.ODD = D2.ODD) A2 ON A.A_TEAM = A2.A_TEAM AND A.ODD = A2.ODD;

        ]]>
        </insert>

    <insert id="insertBasketHandiOverOddSummary">
        <![CDATA[

        INSERT INTO sport.basketball_handi_over_odd_summary (LEAGUE, TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.ODD AS GROUND
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) allHandiCnt
                 FROM sport.basketball_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM,ODD
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) winCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,ODD
             )B ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) allPointCnt
               FROM sport.basketball_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
               GROUP BY A_TEAM,ODD
             ) C ON A.A_TEAM = C.A_TEAM AND A.ODD = C.ODD
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) overCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,ODD
             )D ON A.A_TEAM = D.A_TEAM AND A.ODD = D.ODD
        WHERE allPointCnt != 0 AND allHandiCnt != 0;
        ]]>
    </insert>


    <insert id="truncateBasketSpecialWeekSummary">
        TRUNCATE TABLE sport.basketball_special_week_summary;
    </insert>

    <insert id="truncateBasketQuarterHandiOverWeekSummary">
        TRUNCATE TABLE sport.basketball_quarter_handi_over_week_summary;
    </insert>

    <insert id="truncateBasketHandiOverWeekSummary">
        TRUNCATE TABLE sport.basketball_handi_over_week_summary;
    </insert>

    <insert id="insertBasketSpecialWeekSummary">
        <![CDATA[
        INSERT INTO sport.basketball_special_week_summary(LEAGUE, TEAM, GROUND ,FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER,RDATE)

        SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK as GROUND
             ,IFNULL(ROUND(first_first_point_res/allCnt * 100,1),0) as   first_first_point_per
             ,IFNULL(ROUND(second_first_point_res/allCnt * 100,1),0) as second_first_point_per
             ,IFNULL(ROUND(third_first_point_res/allCnt * 100,1),0) as   third_first_point_per
             ,IFNULL(ROUND(fourth_first_point_res/allCnt * 100,1),0) as fourth_first_point_per
             ,IFNULL(ROUND(first_first_two_point_res/allCnt * 100,1),0) as first_first_two_point_per
             ,IFNULL(ROUND(second_first_two_point_res/allCnt * 100,1),0) as second_first_two_point_per
             ,IFNULL(ROUND(third_first_two_point_res/allCnt * 100,1),0) as third_first_two_point_per
             ,IFNULL(ROUND(fourth_first_two_point_res/allCnt * 100,1),0) as fourth_first_two_point_per
             ,IFNULL(ROUND(first_first_free_two_res/allCnt * 100,1),0) as first_first_free_two_per
             ,IFNULL(ROUND(second_first_free_two_res/allCnt * 100,1),0) as second_first_free_two_per
             ,IFNULL(ROUND(third_first_free_two_res/allCnt * 100,1),0) as third_first_free_two_per
             ,IFNULL(ROUND(fourth_first_free_two_res/allCnt * 100,1),0) as fourth_first_free_two_per
             ,IFNULL(ROUND(first_first_three_point_res/allCnt * 100,1),0) as first_first_three_point_per
             ,IFNULL(ROUND(second_first_three_point_res/allCnt * 100,1),0) as second_first_three_point_per
             ,IFNULL(ROUND(third_first_three_point_res/allCnt * 100,1),0) as third_first_three_point_per
             ,IFNULL(ROUND(fourth_first_three_point_res/allCnt * 100,1),0) as fourth_first_three_point_per
             ,NOW()
        FROM
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
             FROM sport.basketball_data
             WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) A
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as first_first_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) B
            ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as second_first_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) C
            ON A.A_TEAM = C.A_TEAM AND A.DAY_OF_WEEK = C.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as third_first_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) D
            ON A.A_TEAM = D.A_TEAM  AND A.DAY_OF_WEEK = D.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as fourth_first_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) E
            ON A.A_TEAM = E.A_TEAM AND A.DAY_OF_WEEK = E.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as first_first_two_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) B2
            ON A.A_TEAM = B2.A_TEAM  AND A.DAY_OF_WEEK = B2.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as second_first_two_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) C2
            ON A.A_TEAM = C2.A_TEAM  AND A.DAY_OF_WEEK = C2.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as third_first_two_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) D2
            ON A.A_TEAM = D2.A_TEAM AND A.DAY_OF_WEEK = D2.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as fourth_first_two_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) E2
            ON A.A_TEAM = E2.A_TEAM AND A.DAY_OF_WEEK = E2.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as first_first_free_two_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) B3
            ON A.A_TEAM = B3.A_TEAM AND A.DAY_OF_WEEK = B3.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as second_first_free_two_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) C3
            ON A.A_TEAM = C3.A_TEAM AND A.DAY_OF_WEEK = C3.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as third_first_free_two_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) D3
            ON A.A_TEAM = D3.A_TEAM AND A.DAY_OF_WEEK = D3.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as fourth_first_free_two_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) E3
            ON A.A_TEAM = E3.A_TEAM AND A.DAY_OF_WEEK = E3.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as first_first_three_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) B4
            ON A.A_TEAM = B4.A_TEAM AND A.DAY_OF_WEEK = B4.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as second_first_three_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) C4
            ON A.A_TEAM = C4.A_TEAM AND A.DAY_OF_WEEK = C4.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as third_first_three_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) D4
            ON A.A_TEAM = D4.A_TEAM AND A.DAY_OF_WEEK = D4.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as fourth_first_three_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,DAY_OF_WEEK) E4
            ON A.A_TEAM = E4.A_TEAM AND A.DAY_OF_WEEK = E4.DAY_OF_WEEK
        WHERE allCnt != 0 AND A.DAY_OF_WEEK != '없음';

        ]]>
    </insert>

    <insert id="insertBasketQuarterHandiOverWeekSummary">
        <![CDATA[
        INSERT INTO sport.basketball_quarter_handi_over_week_summary(LEAGUE, TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE)

        SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK as GROUND
             ,IFNULL(first_handi_win_per,0)
             ,100 - IFNULL(first_handi_win_per,0) as first_handi_lose_per
             ,IFNULL(second_handi_win_per,0)
             ,100 - IFNULL(second_handi_win_per,0) as second_handi_lose_per
             , IFNULL(third_handi_win_per,0)
             ,100 -  IFNULL(third_handi_win_per,0) as third_handi_lose_per
             , IFNULL(fourth_handi_win_per,0)
             ,100 -  IFNULL(fourth_handi_win_per,0) as fourth_handi_lose_per
             , IFNULL(first_over_per,0)
             ,100 -  IFNULL(first_over_per,0) as first_under_per
             , IFNULL(second_over_per,0)
             ,100 -  IFNULL(second_over_per,0) as second_under_per
             , IFNULL(third_over_per,0)
             ,100 -  IFNULL(third_over_per,0) as third_under_per
             , IFNULL(fourth_over_per,0)
             ,100 -  IFNULL(fourth_over_per,0) as fourth_under_per
             ,NOW()
        FROM
            (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                  ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,DAY_OF_WEEK ) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as first_res
                  FROM sport.basketball_data
                  WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,DAY_OF_WEEK) B
                 ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) A
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                  ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND SECONDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,DAY_OF_WEEK) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as second_res
                  FROM sport.basketball_data
                  WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,DAY_OF_WEEK) B
                 ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) B ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                  ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND THIRDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,DAY_OF_WEEK) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as third_res
                  FROM sport.basketball_data
                  WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,DAY_OF_WEEK) B
                 ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) C ON A.A_TEAM = C.A_TEAM AND A.DAY_OF_WEEK = C.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                  ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,DAY_OF_WEEK) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as fourth_res
                  FROM sport.basketball_data
                  WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,DAY_OF_WEEK) B
                 ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) D ON A.A_TEAM = D.A_TEAM AND A.DAY_OF_WEEK = D.DAY_OF_WEEK
                LEFT OUTER JOIN
            (SELECT A2.LEAGUE,A2.A_TEAM,A2.DAY_OF_WEEK
                  ,first_over_per
                  ,100 - first_over_per as first_handi_under_per
                  ,second_over_per
                  ,100 - second_over_per as second_handi_under_per
                  ,third_over_per
                  ,100 - third_over_per as third_handi_under_per
                  ,fourth_over_per
                  ,100 - fourth_over_per as fourth_handi_under_per
             FROM
                 (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                       ,first_res,ROUND(first_res/allCnt * 100,1) as first_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FIRSTQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,DAY_OF_WEEK) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as first_res
                       FROM sport.basketball_data
                       WHERE FIRSTQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,DAY_OF_WEEK) B
                      ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) A2
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                       ,second_res,ROUND(second_res/allCnt * 100,1) as second_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND SECONDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,DAY_OF_WEEK) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as second_res
                       FROM sport.basketball_data
                       WHERE SECONDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,DAY_OF_WEEK) B
                      ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) B2 ON A2.A_TEAM = B2.A_TEAM AND A2.DAY_OF_WEEK = B2.DAY_OF_WEEK
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                       ,third_res,ROUND(third_res/allCnt * 100,1) as third_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND THIRDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,DAY_OF_WEEK) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as third_res
                       FROM sport.basketball_data
                       WHERE THIRDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,DAY_OF_WEEK) B
                      ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) C2 ON A2.A_TEAM = C2.A_TEAM AND A2.DAY_OF_WEEK = C2.DAY_OF_WEEK
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK,allCnt
                       ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FOURTHQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,DAY_OF_WEEK) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,DAY_OF_WEEK,COUNT(1) as fourth_res
                       FROM sport.basketball_data
                       WHERE FOURTHQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,DAY_OF_WEEK) B
                      ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK  WHERE allCnt != 0) D2 ON A2.A_TEAM = D2.A_TEAM AND A2.DAY_OF_WEEK = D2.DAY_OF_WEEK) A2 ON A.A_TEAM = A2.A_TEAM AND A.DAY_OF_WEEK = A2.DAY_OF_WEEK;

        ]]>
        </insert>

    <insert id="insertBasketHandiOverWeekSummary">
        <![CDATA[
        INSERT INTO sport.basketball_handi_over_week_summary (LEAGUE, TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK AS GROUND
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) allHandiCnt
                 FROM sport.basketball_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM,DAY_OF_WEEK
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) winCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,DAY_OF_WEEK
             )B ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) allPointCnt
               FROM sport.basketball_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
               GROUP BY A_TEAM,DAY_OF_WEEK
             ) C ON A.A_TEAM = C.A_TEAM AND A.DAY_OF_WEEK = C.DAY_OF_WEEK
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) overCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,DAY_OF_WEEK
             )D ON A.A_TEAM = D.A_TEAM AND A.DAY_OF_WEEK = D.DAY_OF_WEEK
        WHERE allPointCnt != 0 AND allHandiCnt != 0;
        ]]>
    </insert>


    <insert id="truncateBasketSpecialRestSummary">
        TRUNCATE TABLE sport.basketball_special_rest_summary;
    </insert>

    <insert id="truncateBasketQuarterHandiOverRestSummary">
        TRUNCATE TABLE sport.basketball_quarter_handi_over_rest_summary;
    </insert>

    <insert id="truncateBasketHandiOverRestSummary">
        TRUNCATE TABLE sport.basketball_handi_over_rest_summary;
    </insert>

    <insert id="insertBasketSpecialRestSummary">
        <![CDATA[
        INSERT INTO sport.basketball_special_rest_summary(LEAGUE, TEAM, GROUND ,FIRST_FIRST_POINT_PER, SECOND_FIRST_POINT_PER, THIRD_FIRST_POINT_PER, FOURTH_FIRST_POINT_PER, FIRST_FIRST_TWO_POINT_PER, SECOND_FIRST_TWO_POINT_PER, THIRD_FIRST_TWO_POINT_PER, FOURTH_FIRST_TWO_POINT_PER, FIRST_FIRST_FREE_TWO_PER, SECOND_FIRST_FREE_TWO_PER, THIRD_FIRST_FREE_TWO_PER, FOURTH_FIRST_FREE_TWO_PER, FIRST_FIRST_THREE_POINT_PER, SECOND_FIRST_THREE_POINT_PER, THIRD_FIRST_THREE_POINT_PER, FOURTH_FIRST_THREE_POINT_PER,RDATE)

        SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY as GROUND
             ,IFNULL(ROUND(first_first_point_res/allCnt * 100,1),0) as   first_first_point_per
             ,IFNULL(ROUND(second_first_point_res/allCnt * 100,1),0) as second_first_point_per
             ,IFNULL(ROUND(third_first_point_res/allCnt * 100,1),0) as   third_first_point_per
             ,IFNULL(ROUND(fourth_first_point_res/allCnt * 100,1),0) as fourth_first_point_per
             ,IFNULL(ROUND(first_first_two_point_res/allCnt * 100,1),0) as first_first_two_point_per
             ,IFNULL(ROUND(second_first_two_point_res/allCnt * 100,1),0) as second_first_two_point_per
             ,IFNULL(ROUND(third_first_two_point_res/allCnt * 100,1),0) as third_first_two_point_per
             ,IFNULL(ROUND(fourth_first_two_point_res/allCnt * 100,1),0) as fourth_first_two_point_per
             ,IFNULL(ROUND(first_first_free_two_res/allCnt * 100,1),0) as first_first_free_two_per
             ,IFNULL(ROUND(second_first_free_two_res/allCnt * 100,1),0) as second_first_free_two_per
             ,IFNULL(ROUND(third_first_free_two_res/allCnt * 100,1),0) as third_first_free_two_per
             ,IFNULL(ROUND(fourth_first_free_two_res/allCnt * 100,1),0) as fourth_first_free_two_per
             ,IFNULL(ROUND(first_first_three_point_res/allCnt * 100,1),0) as first_first_three_point_per
             ,IFNULL(ROUND(second_first_three_point_res/allCnt * 100,1),0) as second_first_three_point_per
             ,IFNULL(ROUND(third_first_three_point_res/allCnt * 100,1),0) as third_first_three_point_per
             ,IFNULL(ROUND(fourth_first_three_point_res/allCnt * 100,1),0) as fourth_first_three_point_per
             ,NOW()
        FROM
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
             FROM sport.basketball_data
             WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as first_first_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) B
            ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as second_first_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) C
            ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_REST_DAY = C.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as third_first_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) D
            ON A.A_TEAM = D.A_TEAM  AND A.A_TEAM_REST_DAY = D.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as fourth_first_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) E
            ON A.A_TEAM = E.A_TEAM AND A.A_TEAM_REST_DAY = E.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as first_first_two_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) B2
            ON A.A_TEAM = B2.A_TEAM  AND A.A_TEAM_REST_DAY = B2.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as second_first_two_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) C2
            ON A.A_TEAM = C2.A_TEAM  AND A.A_TEAM_REST_DAY = C2.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as third_first_two_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) D2
            ON A.A_TEAM = D2.A_TEAM AND A.A_TEAM_REST_DAY = D2.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as fourth_first_two_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_TWO_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) E2
            ON A.A_TEAM = E2.A_TEAM AND A.A_TEAM_REST_DAY = E2.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as first_first_free_two_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) B3
            ON A.A_TEAM = B3.A_TEAM AND A.A_TEAM_REST_DAY = B3.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as second_first_free_two_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) C3
            ON A.A_TEAM = C3.A_TEAM AND A.A_TEAM_REST_DAY = C3.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as third_first_free_two_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) D3
            ON A.A_TEAM = D3.A_TEAM AND A.A_TEAM_REST_DAY = D3.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as fourth_first_free_two_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_FREE_TWO = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) E3
            ON A.A_TEAM = E3.A_TEAM AND A.A_TEAM_REST_DAY = E3.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as first_first_three_point_res
             FROM sport.basketball_data
             WHERE FIRSTQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) B4
            ON A.A_TEAM = B4.A_TEAM AND A.A_TEAM_REST_DAY = B4.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as second_first_three_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) C4
            ON A.A_TEAM = C4.A_TEAM AND A.A_TEAM_REST_DAY = C4.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as third_first_three_point_res
             FROM sport.basketball_data
             WHERE THIRDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) D4
            ON A.A_TEAM = D4.A_TEAM AND A.A_TEAM_REST_DAY = D4.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as fourth_first_three_point_res
             FROM sport.basketball_data
             WHERE SECONDQ_FIRST_THREE_POINT = '승리'
               AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
             GROUP BY A_TEAM,A_TEAM_REST_DAY) E4
            ON A.A_TEAM = E4.A_TEAM AND A.A_TEAM_REST_DAY = E4.A_TEAM_REST_DAY
        WHERE allCnt != 0 AND A.A_TEAM_REST_DAY != '없음';

        ]]>
    </insert>

    <insert id="insertBasketQuarterHandiOverRestSummary">
        <![CDATA[
        INSERT INTO sport.basketball_quarter_handi_over_rest_summary(LEAGUE, TEAM, GROUND,FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, SECOND_HANDI_WIN_PER, SECOND_HANDI_LOSE_PER, THIRD_HANDI_WIN_PER, HIRD_HANDI_LOSE_PER, FOURTH_HANDI_WIN_PER, OURTH_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SECOND_OVER_PER, SECOND_UNDER_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, RDATE)

        SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY as GROUND
             ,IFNULL(first_handi_win_per,0)
             ,100 - IFNULL(first_handi_win_per,0) as first_handi_lose_per
             ,IFNULL(second_handi_win_per,0)
             ,100 - IFNULL(second_handi_win_per,0) as second_handi_lose_per
             , IFNULL(third_handi_win_per,0)
             ,100 -  IFNULL(third_handi_win_per,0) as third_handi_lose_per
             , IFNULL(fourth_handi_win_per,0)
             ,100 -  IFNULL(fourth_handi_win_per,0) as fourth_handi_lose_per
             , IFNULL(first_over_per,0)
             ,100 -  IFNULL(first_over_per,0) as first_under_per
             , IFNULL(second_over_per,0)
             ,100 -  IFNULL(second_over_per,0) as second_under_per
             , IFNULL(third_over_per,0)
             ,100 -  IFNULL(third_over_per,0) as third_under_per
             , IFNULL(fourth_over_per,0)
             ,100 -  IFNULL(fourth_over_per,0) as fourth_under_per
             ,NOW()
        FROM
            (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                  ,first_res,ROUND(first_res/allCnt * 100,1) as first_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,A_TEAM_REST_DAY ) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as first_res
                  FROM sport.basketball_data
                  WHERE FIRSTQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                 ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) A
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                  ,second_res,ROUND(second_res/allCnt * 100,1) as second_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND SECONDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as second_res
                  FROM sport.basketball_data
                  WHERE SECONDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                 ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                  ,third_res,ROUND(third_res/allCnt * 100,1) as third_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND THIRDQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as third_res
                  FROM sport.basketball_data
                  WHERE THIRDQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                 ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) C ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_REST_DAY = C.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                  ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_handi_win_per
             FROM
                 (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                  FROM sport.basketball_data
                  WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                    AND FOURTHQ_HANDI_CAP_RESULT != '적특'
                  GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                     LEFT OUTER JOIN
                 (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as fourth_res
                  FROM sport.basketball_data
                  WHERE FOURTHQ_HANDI_CAP_RESULT = '승리'
                    AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                  GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                 ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) D ON A.A_TEAM = D.A_TEAM AND A.A_TEAM_REST_DAY = D.A_TEAM_REST_DAY
                LEFT OUTER JOIN
            (SELECT A2.LEAGUE,A2.A_TEAM,A2.A_TEAM_REST_DAY
                  ,first_over_per
                  ,100 - first_over_per as first_handi_under_per
                  ,second_over_per
                  ,100 - second_over_per as second_handi_under_per
                  ,third_over_per
                  ,100 - third_over_per as third_handi_under_per
                  ,fourth_over_per
                  ,100 - fourth_over_per as fourth_handi_under_per
             FROM
                 (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                       ,first_res,ROUND(first_res/allCnt * 100,1) as first_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FIRSTQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as first_res
                       FROM sport.basketball_data
                       WHERE FIRSTQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                      ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) A2
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                       ,second_res,ROUND(second_res/allCnt * 100,1) as second_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND SECONDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as second_res
                       FROM sport.basketball_data
                       WHERE SECONDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                      ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) B2 ON A2.A_TEAM = B2.A_TEAM AND A2.A_TEAM_REST_DAY = B2.A_TEAM_REST_DAY
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                       ,third_res,ROUND(third_res/allCnt * 100,1) as third_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND THIRDQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as third_res
                       FROM sport.basketball_data
                       WHERE THIRDQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                      ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) C2 ON A2.A_TEAM = C2.A_TEAM AND A2.A_TEAM_REST_DAY = C2.A_TEAM_REST_DAY
                     LEFT OUTER JOIN
                 (SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY,allCnt
                       ,fourth_res,ROUND(fourth_res/allCnt * 100,1) as fourth_over_per
                  FROM
                      (SELECT LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) as allCnt
                       FROM sport.basketball_data
                       WHERE  MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND FOURTHQ_POINT_LINE_RESULT != '적특'
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) A
                          LEFT OUTER JOIN
                      (SELECT LEAGUE, A_TEAM,A_TEAM_REST_DAY,COUNT(1) as fourth_res
                       FROM sport.basketball_data
                       WHERE FOURTHQ_POINT_LINE_RESULT = '오버'
                         AND MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                       GROUP BY A_TEAM,A_TEAM_REST_DAY) B
                      ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY  WHERE allCnt != 0) D2 ON A2.A_TEAM = D2.A_TEAM AND A2.A_TEAM_REST_DAY = D2.A_TEAM_REST_DAY) A2 ON A.A_TEAM = A2.A_TEAM AND A.A_TEAM_REST_DAY = A2.A_TEAM_REST_DAY;

        ]]>
        </insert>

    <insert id="insertBasketHandiOverRestSummary">
        <![CDATA[
        INSERT INTO sport.basketball_handi_over_rest_summary (LEAGUE, TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY AS GROUND
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) allHandiCnt
                 FROM sport.basketball_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                 GROUP BY A_TEAM,A_TEAM_REST_DAY
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) winCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,A_TEAM_REST_DAY
             )B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) allPointCnt
               FROM sport.basketball_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
               GROUP BY A_TEAM,A_TEAM_REST_DAY
             ) C ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_REST_DAY = C.A_TEAM_REST_DAY
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) overCnt
              FROM sport.basketball_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,A_TEAM_REST_DAY
             )D ON A.A_TEAM = D.A_TEAM AND A.A_TEAM_REST_DAY = D.A_TEAM_REST_DAY
        WHERE allPointCnt != 0 AND allHandiCnt != 0;
        ]]>
    </insert>

    <insert id="truncateHockeySummary">
        TRUNCATE sport.hockey_summary;
    </insert>

    <insert id="insertHockeySummary">
        <![CDATA[

        INSERT INTO hockey_summary (LEAGUE, TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstWinPer
             ,100 - IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstLosePer
             ,IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstOverPer
             ,100 - IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstUnderPer
             ,IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstWinPer
             ,100 - IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstLosePer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,COUNT(1) allHandiCnt
                 FROM sport.hockey_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                   AND ODD != '0'
                 GROUP BY A_TEAM
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,COUNT(1) winCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM
             )B ON A.A_TEAM = B.A_TEAM
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,COUNT(1) allPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM
             ) C ON A.A_TEAM = C.A_TEAM
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,COUNT(1) overCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM
             )D ON A.A_TEAM = D.A_TEAM

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,COUNT(1) allFirstHandiCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM
             )E ON A.A_TEAM = E.A_TEAM
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,COUNT(1) firstWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM
             )F ON A.A_TEAM = F.A_TEAM

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,COUNT(1) allFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM
             )G ON A.A_TEAM = G.A_TEAM
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,COUNT(1) FirstOverCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM
             )H ON A.A_TEAM = H.A_TEAM

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,COUNT(1) allSpecialFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRST_POINT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM
             )I ON A.A_TEAM = I.A_TEAM
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,COUNT(1) SpecialFirstPointWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRST_POINT != '적특'
                AND ODD != '0'
                AND FIRST_POINT = '승리'
              GROUP BY A_TEAM
             )J ON A.A_TEAM = J.A_TEAM;

        ]]>
    </insert>

    <insert id="truncateHockeyGroundSummary">
        TRUNCATE sport.hockey_ground_summary;

    </insert>

    <insert id="insertHockeyGroundSummary">
        <![CDATA[


        INSERT INTO hockey_ground_summary (LEAGUE, TEAM,GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstWinPer
             ,100 - IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstLosePer
             ,IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstOverPer
             ,100 - IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstUnderPer
             ,IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstWinPer
             ,100 - IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstLosePer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allHandiCnt
                 FROM sport.hockey_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                   AND ODD != '0'
                 GROUP BY A_TEAM,GROUND
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) winCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,GROUND
             )B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,GROUND
             ) C ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) overCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,GROUND
             )D ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allFirstHandiCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,GROUND
             )E ON A.A_TEAM = E.A_TEAM AND A.GROUND = E.GROUND
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) firstWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,GROUND
             )F ON A.A_TEAM = F.A_TEAM AND A.GROUND = F.GROUND

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,GROUND
             )G ON A.A_TEAM = G.A_TEAM AND A.GROUND = G.GROUND
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) FirstOverCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,GROUND
             )H ON A.A_TEAM = H.A_TEAM AND A.GROUND = H.GROUND

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allSpecialFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRST_POINT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,GROUND
             )I ON A.A_TEAM = I.A_TEAM AND A.GROUND = I.GROUND
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) SpecialFirstPointWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRST_POINT != '적특'
                AND ODD != '0'
                AND FIRST_POINT = '승리'
              GROUP BY A_TEAM,GROUND
             )J ON A.A_TEAM = J.A_TEAM AND A.GROUND = J.GROUND;
        ]]>
    </insert>

    <insert id="truncateHockeyOddSummary">
        TRUNCATE sport.hockey_odd_summary;

    </insert>

    <insert id="insertHockeyOddSummary">
        <![CDATA[
        INSERT INTO hockey_odd_summary (LEAGUE, TEAM,GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.ODD AS GROUND
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstWinPer
             ,100 - IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstLosePer
             ,IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstOverPer
             ,100 - IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstUnderPer
             ,IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstWinPer
             ,100 - IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstLosePer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) allHandiCnt
                 FROM sport.hockey_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                   AND ODD != '0'
                 GROUP BY A_TEAM,ODD
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) winCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,ODD
             )B ON A.A_TEAM = B.A_TEAM AND A.ODD = B.ODD
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) allPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,ODD
             ) C ON A.A_TEAM = C.A_TEAM AND A.ODD = C.ODD
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) overCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,ODD
             )D ON A.A_TEAM = D.A_TEAM AND A.ODD = D.ODD

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) allFirstHandiCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,ODD
             )E ON A.A_TEAM = E.A_TEAM AND A.ODD = E.ODD
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) firstWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,ODD
             )F ON A.A_TEAM = F.A_TEAM AND A.ODD = F.ODD

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) allFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,ODD
             )G ON A.A_TEAM = G.A_TEAM AND A.ODD = G.ODD
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) FirstOverCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,ODD
             )H ON A.A_TEAM = H.A_TEAM AND A.ODD = H.ODD

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) allSpecialFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRST_POINT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,ODD
             )I ON A.A_TEAM = I.A_TEAM AND A.ODD = I.ODD
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,ODD,COUNT(1) SpecialFirstPointWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRST_POINT != '적특'
                AND ODD != '0'
                AND FIRST_POINT = '승리'
              GROUP BY A_TEAM,ODD
             )J ON A.A_TEAM = J.A_TEAM AND A.ODD = J.ODD;

        ]]>
    </insert>

    <insert id="truncateHockeyWeekSummary">
        TRUNCATE sport.hockey_week_summary;

    </insert>

    <insert id="insertHockeyWeekSummary">
        <![CDATA[
        INSERT INTO hockey_week_summary (LEAGUE, TEAM,GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.DAY_OF_WEEK AS GROUND
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstWinPer
             ,100 - IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstLosePer
             ,IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstOverPer
             ,100 - IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstUnderPer
             ,IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstWinPer
             ,100 - IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstLosePer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) allHandiCnt
                 FROM sport.hockey_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                   AND ODD != '0'
                 GROUP BY A_TEAM,DAY_OF_WEEK
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) winCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,DAY_OF_WEEK
             )B ON A.A_TEAM = B.A_TEAM AND A.DAY_OF_WEEK = B.DAY_OF_WEEK
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) allPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,DAY_OF_WEEK
             ) C ON A.A_TEAM = C.A_TEAM AND A.DAY_OF_WEEK = C.DAY_OF_WEEK
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) overCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,DAY_OF_WEEK
             )D ON A.A_TEAM = D.A_TEAM AND A.DAY_OF_WEEK = D.DAY_OF_WEEK

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) allFirstHandiCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,DAY_OF_WEEK
             )E ON A.A_TEAM = E.A_TEAM AND A.DAY_OF_WEEK = E.DAY_OF_WEEK
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) firstWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,DAY_OF_WEEK
             )F ON A.A_TEAM = F.A_TEAM AND A.DAY_OF_WEEK = F.DAY_OF_WEEK

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) allFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,DAY_OF_WEEK
             )G ON A.A_TEAM = G.A_TEAM AND A.DAY_OF_WEEK = G.DAY_OF_WEEK
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) FirstOverCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,DAY_OF_WEEK
             )H ON A.A_TEAM = H.A_TEAM AND A.DAY_OF_WEEK = H.DAY_OF_WEEK

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) allSpecialFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRST_POINT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,DAY_OF_WEEK
             )I ON A.A_TEAM = I.A_TEAM AND A.DAY_OF_WEEK = I.DAY_OF_WEEK
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,DAY_OF_WEEK,COUNT(1) SpecialFirstPointWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRST_POINT != '적특'
                AND ODD != '0'
                AND FIRST_POINT = '승리'
              GROUP BY A_TEAM,DAY_OF_WEEK
             )J ON A.A_TEAM = J.A_TEAM AND A.DAY_OF_WEEK = J.DAY_OF_WEEK;
        ]]>
    </insert>


    <insert id="truncateHockeyRestSummary">
        TRUNCATE sport.hockey_rest_summary;

    </insert>

    <insert id="insertHockeyRestSummary">
        <![CDATA[

        INSERT INTO hockey_rest_summary (LEAGUE, TEAM,GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER, RDATE)
        SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_REST_DAY AS GROUND
             ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
             ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as losePer
             ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as overPer
             ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as underPer
             ,IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstWinPer
             ,100 - IFNULL(ROUND(firstWinCnt/allFirstHandiCnt * 100,1),0) as firstLosePer
             ,IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstOverPer
             ,100 - IFNULL(ROUND(FirstOverCnt/allFirstPointCnt * 100,1),0) as firstUnderPer
             ,IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstWinPer
             ,100 - IFNULL(ROUND(SpecialFirstPointWinCnt/allSpecialFirstPointCnt * 100,1),0) as specialFirstLosePer
             ,NOW()
        FROM (
                 SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) allHandiCnt
                 FROM sport.hockey_data
                 WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                   AND HANDI_CAP_RESULT != '적특'
                   AND ODD != '0'
                 GROUP BY A_TEAM,A_TEAM_REST_DAY
             ) A
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) winCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,A_TEAM_REST_DAY
             )B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_REST_DAY = B.A_TEAM_REST_DAY
                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) allPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,A_TEAM_REST_DAY
             ) C ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_REST_DAY = C.A_TEAM_REST_DAY
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) overCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,A_TEAM_REST_DAY
             )D ON A.A_TEAM = D.A_TEAM AND A.A_TEAM_REST_DAY = D.A_TEAM_REST_DAY

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) allFirstHandiCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,A_TEAM_REST_DAY
             )E ON A.A_TEAM = E.A_TEAM AND A.A_TEAM_REST_DAY = E.A_TEAM_REST_DAY
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) firstWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_HANDI_CAP_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_HANDI_CAP_RESULT = '승리'
              GROUP BY A_TEAM,A_TEAM_REST_DAY
             )F ON A.A_TEAM = F.A_TEAM AND A.A_TEAM_REST_DAY = F.A_TEAM_REST_DAY

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) allFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRSTQ_POINT_LINE_RESULT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,A_TEAM_REST_DAY
             )G ON A.A_TEAM = G.A_TEAM AND A.A_TEAM_REST_DAY = G.A_TEAM_REST_DAY
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) FirstOverCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRSTQ_POINT_LINE_RESULT != '적특'
                AND ODD != '0'
                AND FIRSTQ_POINT_LINE_RESULT = '오버'
              GROUP BY A_TEAM,A_TEAM_REST_DAY
             )H ON A.A_TEAM = H.A_TEAM AND A.A_TEAM_REST_DAY = H.A_TEAM_REST_DAY

                 LEFT OUTER JOIN
             ( SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) allSpecialFirstPointCnt
               FROM sport.hockey_data
               WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                 AND FIRST_POINT != '적특'
                 AND ODD != '0'
               GROUP BY A_TEAM,A_TEAM_REST_DAY
             )I ON A.A_TEAM = I.A_TEAM AND A.A_TEAM_REST_DAY = I.A_TEAM_REST_DAY
                 LEFT OUTER JOIN
             (SELECT  LEAGUE,A_TEAM,A_TEAM_REST_DAY,COUNT(1) SpecialFirstPointWinCnt
              FROM sport.hockey_data
              WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                AND FIRST_POINT != '적특'
                AND ODD != '0'
                AND FIRST_POINT = '승리'
              GROUP BY A_TEAM,A_TEAM_REST_DAY
             )J ON A.A_TEAM = J.A_TEAM AND A.A_TEAM_REST_DAY = J.A_TEAM_REST_DAY;
        ]]>
    </insert>

    <select id="selectAllHockeySummary" resultType="HashMap">
        <![CDATA[
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
                CASE A.GROUND WHEN '홈' THEN 1
                              ELSE 2
                    END AS PRO
                ,TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM
                 FROM sport.hockey_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
               FROM sport.hockey_summary
             ) B ON A.A_TEAM = B.TEAM
        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
                CASE A.GROUND WHEN '홈' THEN 3
                              ELSE 4
                    END AS PRO
                ,  TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM
                 FROM sport.hockey_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
               FROM sport.hockey_ground_summary
             ) B ON A.A_TEAM = B.TEAM AND A.GROUND = B.GROUND
        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
                CASE A.GROUND WHEN '홈' THEN 5
                              ELSE 6
                    END AS PRO
                ,  TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM,ODD
                 FROM sport.hockey_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
               FROM sport.hockey_odd_summary
             ) B ON A.A_TEAM = B.TEAM AND A.ODD = B.GROUND

        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
                CASE A.GROUND WHEN '홈' THEN 7
                              ELSE 8
                    END AS PRO
                , TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM,A_TEAM_REST_DAY
                 FROM sport.hockey_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
               FROM sport.hockey_rest_summary
             ) B ON A.A_TEAM = B.TEAM AND A.A_TEAM_REST_DAY = B.GROUND

        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,A.MATCH_DATE ,A.A_TEAM,B.GROUND,
                CASE A.GROUND WHEN '홈' THEN 9
                              ELSE 10
                    END AS PRO
                , TEAM, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM,DAY_OF_WEEK
                 FROM sport.hockey_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, FIRST_HANDI_WIN_PER, FIRST_HANDI_LOSE_PER, FIRST_OVER_PER, FIRST_UNDER_PER, SPECIAL_FIRST_POINT_WIN_PER, SPECIAL_FIRST_POINT_LOSE_PER
               FROM sport.hockey_week_summary
             ) B ON A.A_TEAM = B.TEAM AND A.DAY_OF_WEEK = B.GROUND

        UNION
        SELECT  A.idx,A.MATCH_TIME,A.GAME_ID,null ,null,null,
                CASE A.GROUND WHEN '홈' THEN 0
                              ELSE 0
                    END AS PRO
                ,  null, null, null, null , null, null, null, null, null, null, null

        FROM (
                 SELECT idx,GAME_ID,GROUND,MATCH_DATE,MATCH_TIME, LEAGUE, A_TEAM
                 FROM sport.hockey_data
                 WHERE MATCH_DATE = DATE(DATE_ADD(NOW(),INTERVAL 1 DAY))
             ) A INNER JOIN
             ( SELECT TEAM, GROUND,HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER
               FROM sport.hockey_summary
             ) B ON A.A_TEAM = B.TEAM
        WHERE A.GROUND = '홈'

        ORDER BY MATCH_TIME,GAME_ID DESC , PRO   ;



        ]]>



    </select>

    <insert id="insertBaseballMatch" parameterType="blog.model.BaseballModel">
        INSERT INTO sport.baseball_data(GAME_ID, LEAGUE, GROUND,STADIUM,MATCH_DATE, DAY_OF_WEEK, MATCH_TIME,  A_TEAM, B_TEAM)
        VALUES (
                   #{gameId},
                   #{league},
                   #{ground},
                   #{stadium},
                   #{date},
                   #{dayOfWeek},
                   #{time},
                   #{aTeam},
                   #{bTeam}
               )
    </insert>

    <update id="updateBaseballStat" parameterType="blog.model.BaseballModel">
        <![CDATA[


        UPDATE sport.baseball_data
        SET
            LEAGUE      =#{league},
            GROUND      =#{ground},
            STADIUM     =#{stadium},
            MATCH_DATE      =#{date},
            DAY_OF_WEEK     =#{dayOfWeek},
            MATCH_TIME      =#{time},
            A_TEAM_REST_DAY = IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM (SELECT MATCH_DATE FROM  sport.baseball_data A WHERE A_TEAM = #{aTeam} AND LEAGUE = #{league} AND A_TEAM_PITCHER = #{aTeamPitcher} AND MATCH_DATE <  #{date} ORDER BY idx DESC LIMIT 1) A ))) -1,0),
            A_TEAM_PITCHER      =#{aTeamPitcher},
            A_TEAM_PITCHER_HAND = IFNULL((SELECT HAND FROM baseball_pitcher_data B WHERE B.TEAM = #{aTeam} AND B.PITCHER = #{aTeamPitcher}),'0'),
            A_TEAM      =#{aTeam},
            A_TEAM_TOTAL_POINT      =  #{aTeamTotalPoint},
            B_TEAM_TOTAL_POINT      =  #{bTeamTotalPoint},
            B_TEAM      =#{bTeam},
            B_TEAM_PITCHER      =#{bTeamPitcher},
            B_TEAM_PITCHER_HAND = IFNULL((SELECT HAND FROM baseball_pitcher_data B WHERE B.TEAM = #{bTeam} AND B.PITCHER = #{bTeamPitcher}),'0'),
            B_TEAM_REST_DAY =    IFNULL((SELECT  DATEDIFF(#{date} ,(SELECT MATCH_DATE FROM (SELECT MATCH_DATE FROM  sport.baseball_data B WHERE B_TEAM = #{bTeam}  AND LEAGUE = #{league} AND B_TEAM_PITCHER = #{bTeamPitcher} AND MATCH_DATE <  #{date} ORDER BY idx DESC LIMIT 1) A ))) -1,0),
            HANDI_CAP       =      #{handiCap},
            HANDI_CAP_RESULT        =#{handiCapResult},
            ODD     =#{odd},
            POINT_LINE      =#{pointLine},
            POINT_LINE_RESULT       =#{pointLineResult},
            A_TEAM_THIRD_POINT     =#{aTeamThirdPoint},
            B_TEAM_THIRD_POINT        =#{bTeamThirdPoint},
            THIRD_HANDI_CAP        =#{thirdHandiCap},
            THIRD_HANDI_CAP_RESULT     =#{thirdHandiCapResult},
            THIRD_POINT_LINE       =#{thirdPointLine},
            THIRD_POINT_LINE_RESULT        =#{thirdPointLineResult},
            A_TEAM_FOURTH_POINT     =#{aTeamFourthPoint},
            B_TEAM_FOURTH_POINT        =#{bTeamFourthPoint},
            FOURTH_HANDI_CAP        =#{fourthHandiCap},
            FOURTH_HANDI_CAP_RESULT     =#{fourthHandiCapResult},
            FOURTH_POINT_LINE       =#{fourthPointLine},
            FOURTH_POINT_LINE_RESULT        =#{fourthPointLineResult},
            A_TEAM_FIFTH_POINT      =#{aTeamFifthPoint},
            B_TEAM_FIFTH_POINT      =#{bTeamFifthPoint},
            FIFTH_HANDI_CAP     =#{fifthHandiCap},
            FIFTH_HANDI_CAP_RESULT      =#{fifthHandiCapResult},
            FIFTH_POINT_LINE        =#{fifthPointLine},
            FIFTH_POINT_LINE_RESULT       =#{fifthPointLineResult},
            FIRST_STRIKEOUT     =#{firstStrikeOut},
            FIRST_HOMERUN       =#{firstHomerun},
            FRIST_BASEONBALL        =#{firstBaseOnBall},
            FRIST_POINT     =#{firstScore},
            SECEND_POINT        =#{secondScore},
            THRID_POINT     =#{thirdScore},
            FOURTH_POINT        =#{fourthScore},
            FIFTH_POINT     =#{fifthScore},
            SIXTH_POINT     =#{sixthScore},
            SEVENTH_POINT       =#{seventhScore},
            EIGHTH_POINT        =#{eighthScore},
            NINTH_POINT     =#{ninthScore},
            EXTEND_POINT     =#{extendScore},
            EXTEND_YN       =#{extendYn}

        WHERE
            GAME_ID   =     #{gameId} AND
            LEAGUE   =     #{league} AND
            GROUND   =     #{ground} AND
            MATCH_DATE   =  #{date} AND
            A_TEAM   =     #{aTeam} AND
            B_TEAM   =     #{bTeam} AND
            UPDATE_YN = 1

        ]]>

    </update>

    <select id="selectBaseballStat"  resultType="HashMap">
        SELECT  IDX, GAME_ID, LEAGUE, GROUND, STADIUM, MATCH_DATE, DAY_OF_WEEK, MATCH_TIME, A_TEAM_REST_DAY, A_TEAM_PITCHER,A_TEAM_PITCHER_HAND, A_TEAM, A_TEAM_TOTAL_POINT, B_TEAM_TOTAL_POINT, B_TEAM, B_TEAM_PITCHER,B_TEAM_PITCHER_HAND, B_TEAM_REST_DAY, HANDI_CAP, HANDI_CAP_RESULT, ODD, POINT_LINE, POINT_LINE_RESULT, A_TEAM_THIRD_POINT, B_TEAM_THIRD_POINT, THIRD_HANDI_CAP, THIRD_HANDI_CAP_RESULT, THIRD_POINT_LINE, THIRD_POINT_LINE_RESULT, A_TEAM_FOURTH_POINT, B_TEAM_FOURTH_POINT, FOURTH_HANDI_CAP, FOURTH_HANDI_CAP_RESULT, FOURTH_POINT_LINE, FOURTH_POINT_LINE_RESULT, A_TEAM_FIFTH_POINT, B_TEAM_FIFTH_POINT, FIFTH_HANDI_CAP, FIFTH_HANDI_CAP_RESULT, FIFTH_POINT_LINE, FIFTH_POINT_LINE_RESULT, FIRST_STRIKEOUT, FIRST_HOMERUN, FRIST_BASEONBALL, FRIST_POINT, SECEND_POINT, THRID_POINT, FOURTH_POINT, FIFTH_POINT, SIXTH_POINT, SEVENTH_POINT, EIGHTH_POINT, NINTH_POINT, EXTEND_POINT,EXTEND_YN
        FROM sport.baseball_data
        WHERE A_TEAM_TOTAL_POINT != 99
        ORDER BY MATCH_DATE,GAME_ID;
    </select>

    <insert id="insertBaseballGroundSummary">
        <![CDATA[
        INSERT INTO baseball_ground_summary(LEAGUE, TEAM, GROUND, WIN_PER, LOSE_PER, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, THIRD_HANDI_WIN_PER, THIRD_HANDI_LOSE_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_HANDI_WIN_PER,
        FOURTH_HANDI_LOSE_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, FIFTH_HANDI_WIN_PER, FIFTH_HANDI_LOSE_PER, FIFTH_OVER_PER, FIFTH_UNDER_PER, FIRST_STRIKE_PER, FIRST_BALL_PER, FIRST_HOMERUN_PER)

        SELECT  MATCHWIN.LEAGUE,MATCHWIN.A_TEAM,MATCHWIN.GROUND ,winPer,losePer,fullWinPer,fullLosePer,fullOverPer,fullUnderPer
        ,thirdwinPer,thirdlosePer,thirdoverPer,thirdunderPer,fourthwinPer,fourthlosePer,fourthoverPer,fourthunderPer,fifthwinPer,fifthlosePer,fifthoverPer,fifthunderPer,strikeWinPer,baseWinPer,homeRunWinPer
        FROM(
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
        ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as losePer
        ,NOW()
        FROM (
        SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allHandiCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )

        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) winCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND A_TEAM_TOTAL_POINT > B_TEAM_TOTAL_POINT
        GROUP BY LEAGUE,A_TEAM,GROUND
        )B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE) MATCHWIN
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as fullWinPer
        ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as fullLosePer
        ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as fullOverPer
        ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as fullUnderPer
        ,NOW()
        FROM (
        SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allHandiCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND HANDI_CAP_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) winCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND HANDI_CAP_RESULT != '적특'
        AND HANDI_CAP_RESULT = '승리'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE
        LEFT OUTER JOIN
        ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allPointCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND POINT_LINE_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) C ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND  AND A.LEAGUE = C.LEAGUE
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) overCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND POINT_LINE_RESULT != '적특'
        AND POINT_LINE_RESULT = '오버'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )D ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND  AND A.LEAGUE = D.LEAGUE) HANDIWIN
        ON MATCHWIN.LEAGUE = HANDIWIN.LEAGUE AND MATCHWIN.A_TEAM = HANDIWIN.A_TEAM AND MATCHWIN.GROUND = HANDIWIN.GROUND
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as thirdwinPer
        ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as thirdlosePer
        ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as thirdoverPer
        ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as thirdunderPer
        ,NOW()
        FROM (
        SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allHandiCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND THIRD_HANDI_CAP_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) winCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND THIRD_HANDI_CAP_RESULT != '적특'
        AND THIRD_HANDI_CAP_RESULT = '승리'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE
        LEFT OUTER JOIN
        ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allPointCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND THIRD_POINT_LINE_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) C ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND  AND A.LEAGUE = C.LEAGUE
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) overCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND THIRD_POINT_LINE_RESULT != '적특'
        AND THIRD_POINT_LINE_RESULT = '오버'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )D ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND  AND A.LEAGUE = D.LEAGUE) THIRD
        ON MATCHWIN.LEAGUE = THIRD.LEAGUE AND MATCHWIN.A_TEAM = THIRD.A_TEAM AND MATCHWIN.GROUND = THIRD.GROUND
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as fourthwinPer
        ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as fourthlosePer
        ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as fourthoverPer
        ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as fourthunderPer
        ,NOW()
        FROM (
        SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allHandiCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FOURTH_HANDI_CAP_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) winCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FOURTH_HANDI_CAP_RESULT != '적특'
        AND FOURTH_HANDI_CAP_RESULT = '승리'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE
        LEFT OUTER JOIN
        ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allPointCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FOURTH_POINT_LINE_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) C ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND  AND A.LEAGUE = C.LEAGUE
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) overCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FOURTH_POINT_LINE_RESULT != '적특'
        AND FOURTH_POINT_LINE_RESULT = '오버'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )D ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND  AND A.LEAGUE = D.LEAGUE) FOURTH
        ON MATCHWIN.LEAGUE = FOURTH.LEAGUE AND MATCHWIN.A_TEAM = FOURTH.A_TEAM AND MATCHWIN.GROUND = FOURTH.GROUND
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as fifthwinPer
        ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as fifthlosePer
        ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as fifthoverPer
        ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as fifthunderPer
        ,NOW()
        FROM (
        SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allHandiCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIFTH_HANDI_CAP_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) winCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIFTH_HANDI_CAP_RESULT != '적특'
        AND FIFTH_HANDI_CAP_RESULT = '승리'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE
        LEFT OUTER JOIN
        ( SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) allPointCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIFTH_POINT_LINE_RESULT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) C ON A.A_TEAM = C.A_TEAM AND A.GROUND = C.GROUND  AND A.LEAGUE = C.LEAGUE
        LEFT OUTER JOIN
        (SELECT  LEAGUE,A_TEAM,GROUND,COUNT(1) overCnt
        FROM sport.baseball_data
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIFTH_POINT_LINE_RESULT != '적특'
        AND FIFTH_POINT_LINE_RESULT = '오버'
        GROUP BY LEAGUE,A_TEAM,GROUND
        )D ON A.A_TEAM = D.A_TEAM AND A.GROUND = D.GROUND  AND A.LEAGUE = D.LEAGUE) FIFTH
        ON MATCHWIN.LEAGUE = FIFTH.LEAGUE AND MATCHWIN.A_TEAM = FIFTH.A_TEAM AND MATCHWIN.GROUND = FIFTH.GROUND
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(strikePer/allMatch * 100,1),0) as strikeWinPer
        ,100 - IFNULL(ROUND(strikePer/allMatch * 100,1),0)  as strikeLosePer
        FROM (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND,COUNT(1) allMatch
        FROM baseball_data A
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIRST_STRIKEOUT != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND,COUNT(1) strikePer
        FROM baseball_data A
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIRST_STRIKEOUT != '적특'
        AND FIRST_STRIKEOUT = '승리'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE  ) STRIKE
        ON MATCHWIN.LEAGUE = STRIKE.LEAGUE AND MATCHWIN.A_TEAM = STRIKE.A_TEAM AND MATCHWIN.GROUND = STRIKE.GROUND
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(baseBallPer/allMatch * 100,1),0) as baseWinPer
        ,100 - IFNULL(ROUND(baseBallPer/allMatch * 100,1),0)  as baseLosePer
        FROM (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND,COUNT(1) allMatch
        FROM baseball_data A
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FRIST_BASEONBALL != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND,COUNT(1) baseBallPer
        FROM baseball_data A
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FRIST_BASEONBALL != '적특'
        AND FRIST_BASEONBALL = '승리'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE ) BASEBALL
        ON MATCHWIN.LEAGUE = BASEBALL.LEAGUE AND MATCHWIN.A_TEAM = BASEBALL.A_TEAM AND MATCHWIN.GROUND = BASEBALL.GROUND
        LEFT OUTER JOIN
        (

        SELECT A.LEAGUE,A.A_TEAM,A.GROUND
        ,IFNULL(ROUND(homeRunPer/allMatch * 100,1),0) as homeRunWinPer
        ,100 - IFNULL(ROUND(homeRunPer/allMatch * 100,1),0)  as homeRunLosePer
        FROM (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND,COUNT(1) allMatch
        FROM baseball_data A
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIRST_HOMERUN != '적특'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) A
        LEFT OUTER JOIN
        (
        SELECT A.LEAGUE,A.A_TEAM,A.GROUND,COUNT(1) homeRunPer
        FROM baseball_data A
        WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
        AND FIRST_HOMERUN != '적특'
        AND FIRST_HOMERUN = '승리'
        GROUP BY LEAGUE,A_TEAM,GROUND
        ) B ON A.A_TEAM = B.A_TEAM AND A.GROUND = B.GROUND AND A.LEAGUE = B.LEAGUE
        ) HOMERUN
        ON MATCHWIN.LEAGUE = HOMERUN.LEAGUE AND MATCHWIN.A_TEAM = HOMERUN.A_TEAM AND MATCHWIN.GROUND = HOMERUN.GROUND



        ;        ]]>
    </insert>

    <insert id="insertBaseballPitcherSummary">
        <![CDATA[
        INSERT INTO baseball_pitcher_summary(LEAGUE, TEAM, PITCHER, WIN_PER, LOSE_PER, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, THIRD_HANDI_WIN_PER, THIRD_HANDI_LOSE_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_HANDI_WIN_PER,
                                             FOURTH_HANDI_LOSE_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, FIFTH_HANDI_WIN_PER, FIFTH_HANDI_LOSE_PER, FIFTH_OVER_PER, FIFTH_UNDER_PER, FIRST_STRIKE_PER, FIRST_BALL_PER, FIRST_HOMERUN_PER)

        SELECT  MATCHWIN.LEAGUE,MATCHWIN.A_TEAM,MATCHWIN.A_TEAM_PITCHER ,winPer,losePer,fullWinPer,fullLosePer,fullOverPer,fullUnderPer
             ,thirdwinPer,thirdlosePer,thirdoverPer,thirdlosePer,fourthwinPer,fourthlosePer,fourthoverPer,fourthlosePer,fifthwinPer,fifthlosePer,fifthoverPer,fifthlosePer,strikeWinPer,baseWinPer,homeRunWinPer
        FROM(
                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as winPer
                     ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as losePer
                     ,NOW()
                FROM (
                         SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allHandiCnt
                         FROM sport.baseball_data
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) winCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99

                        AND A_TEAM_TOTAL_POINT > B_TEAM_TOTAL_POINT
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE) MATCHWIN
                LEFT OUTER JOIN
            (
                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as fullWinPer
                     ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as fullLosePer
                     ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as fullOverPer
                     ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as fullUnderPer
                     ,NOW()
                FROM (
                         SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allHandiCnt
                         FROM sport.baseball_data
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND HANDI_CAP_RESULT != '적특'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) winCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND HANDI_CAP_RESULT != '적특'
                        AND HANDI_CAP_RESULT = '승리'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE
                         LEFT OUTER JOIN
                     ( SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allPointCnt
                       FROM sport.baseball_data
                       WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND LEAGUE != '퓨처스'
                         AND A_TEAM_TOTAL_POINT != 99
                         AND POINT_LINE_RESULT != '적특'
                       GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) C ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_PITCHER = C.A_TEAM_PITCHER  AND A.LEAGUE = C.LEAGUE
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) overCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND POINT_LINE_RESULT != '적특'
                        AND POINT_LINE_RESULT = '오버'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )D ON A.A_TEAM = D.A_TEAM AND A.A_TEAM_PITCHER = D.A_TEAM_PITCHER  AND A.LEAGUE = D.LEAGUE) HANDIWIN
            ON MATCHWIN.LEAGUE = HANDIWIN.LEAGUE AND MATCHWIN.A_TEAM = HANDIWIN.A_TEAM AND MATCHWIN.A_TEAM_PITCHER = HANDIWIN.A_TEAM_PITCHER
                LEFT OUTER JOIN
            (
                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as thirdwinPer
                     ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as thirdlosePer
                     ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as thirdoverPer
                     ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as thirdunderPer
                     ,NOW()
                FROM (
                         SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allHandiCnt
                         FROM sport.baseball_data
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND THIRD_HANDI_CAP_RESULT != '적특'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) winCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND THIRD_HANDI_CAP_RESULT != '적특'
                        AND THIRD_HANDI_CAP_RESULT = '승리'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE
                         LEFT OUTER JOIN
                     ( SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allPointCnt
                       FROM sport.baseball_data
                       WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND LEAGUE != '퓨처스'
                         AND A_TEAM_TOTAL_POINT != 99
                         AND THIRD_POINT_LINE_RESULT != '적특'
                       GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) C ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_PITCHER = C.A_TEAM_PITCHER  AND A.LEAGUE = C.LEAGUE
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) overCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND THIRD_POINT_LINE_RESULT != '적특'
                        AND THIRD_POINT_LINE_RESULT = '오버'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )D ON A.A_TEAM = D.A_TEAM AND A.A_TEAM_PITCHER = D.A_TEAM_PITCHER  AND A.LEAGUE = D.LEAGUE) THIRD
            ON MATCHWIN.LEAGUE = THIRD.LEAGUE AND MATCHWIN.A_TEAM = THIRD.A_TEAM AND MATCHWIN.A_TEAM_PITCHER = THIRD.A_TEAM_PITCHER
                LEFT OUTER JOIN
            (
                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as fourthwinPer
                     ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as fourthlosePer
                     ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as fourthoverPer
                     ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as fourthunderPer
                     ,NOW()
                FROM (
                         SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allHandiCnt
                         FROM sport.baseball_data
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FOURTH_HANDI_CAP_RESULT != '적특'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) winCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND FOURTH_HANDI_CAP_RESULT != '적특'
                        AND FOURTH_HANDI_CAP_RESULT = '승리'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE
                         LEFT OUTER JOIN
                     ( SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allPointCnt
                       FROM sport.baseball_data
                       WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND LEAGUE != '퓨처스'
                         AND A_TEAM_TOTAL_POINT != 99
                         AND FOURTH_POINT_LINE_RESULT != '적특'
                       GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) C ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_PITCHER = C.A_TEAM_PITCHER  AND A.LEAGUE = C.LEAGUE
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) overCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND FOURTH_POINT_LINE_RESULT != '적특'
                        AND FOURTH_POINT_LINE_RESULT = '오버'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )D ON A.A_TEAM = D.A_TEAM AND A.A_TEAM_PITCHER = D.A_TEAM_PITCHER  AND A.LEAGUE = D.LEAGUE) FOURTH
            ON MATCHWIN.LEAGUE = FOURTH.LEAGUE AND MATCHWIN.A_TEAM = FOURTH.A_TEAM AND MATCHWIN.A_TEAM_PITCHER = FOURTH.A_TEAM_PITCHER
                LEFT OUTER JOIN
            (
                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0) as fifthwinPer
                     ,100 - IFNULL(ROUND(winCnt/allHandiCnt * 100,1),0)  as fifthlosePer
                     ,IFNULL(ROUND(overCnt/allPointCnt * 100,1),0) as fifthoverPer
                     ,100 - IFNULL(ROUND(overCnt/allPointCnt * 100,1),0)  as fifthunderPer
                     ,NOW()
                FROM (
                         SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allHandiCnt
                         FROM sport.baseball_data
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FIFTH_HANDI_CAP_RESULT != '적특'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) winCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND FIFTH_HANDI_CAP_RESULT != '적특'
                        AND FIFTH_HANDI_CAP_RESULT = '승리'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE
                         LEFT OUTER JOIN
                     ( SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) allPointCnt
                       FROM sport.baseball_data
                       WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                         AND LEAGUE != '퓨처스'
                         AND A_TEAM_TOTAL_POINT != 99
                         AND FIFTH_POINT_LINE_RESULT != '적특'
                       GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) C ON A.A_TEAM = C.A_TEAM AND A.A_TEAM_PITCHER = C.A_TEAM_PITCHER  AND A.LEAGUE = C.LEAGUE
                         LEFT OUTER JOIN
                     (SELECT  LEAGUE,A_TEAM,A_TEAM_PITCHER,COUNT(1) overCnt
                      FROM sport.baseball_data
                      WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                        AND LEAGUE != '퓨처스'
                        AND A_TEAM_TOTAL_POINT != 99
                        AND FIFTH_POINT_LINE_RESULT != '적특'
                        AND FIFTH_POINT_LINE_RESULT = '오버'
                      GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     )D ON A.A_TEAM = D.A_TEAM AND A.A_TEAM_PITCHER = D.A_TEAM_PITCHER  AND A.LEAGUE = D.LEAGUE) FIFTH
            ON MATCHWIN.LEAGUE = FIFTH.LEAGUE AND MATCHWIN.A_TEAM = FIFTH.A_TEAM AND MATCHWIN.A_TEAM_PITCHER = FIFTH.A_TEAM_PITCHER
                LEFT OUTER JOIN
            (
                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(strikePer/allMatch * 100,1),0) as strikeWinPer
                     ,100 - IFNULL(ROUND(strikePer/allMatch * 100,1),0)  as strikeLosePer
                FROM (
                         SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER,COUNT(1) allMatch
                         FROM baseball_data A
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FIRST_STRIKEOUT != '적특'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (
                         SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER,COUNT(1) strikePer
                         FROM baseball_data A
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FIRST_STRIKEOUT != '적특'
                           AND FIRST_STRIKEOUT = '승리'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE  ) STRIKE
            ON MATCHWIN.LEAGUE = STRIKE.LEAGUE AND MATCHWIN.A_TEAM = STRIKE.A_TEAM AND MATCHWIN.A_TEAM_PITCHER = STRIKE.A_TEAM_PITCHER
                LEFT OUTER JOIN
            (
                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(baseBallPer/allMatch * 100,1),0) as baseWinPer
                     ,100 - IFNULL(ROUND(baseBallPer/allMatch * 100,1),0)  as baseLosePer
                FROM (
                         SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER,COUNT(1) allMatch
                         FROM baseball_data A
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FRIST_BASEONBALL != '적특'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (
                         SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER,COUNT(1) baseBallPer
                         FROM baseball_data A
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FRIST_BASEONBALL != '적특'
                           AND FRIST_BASEONBALL = '승리'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE ) BASEBALL
            ON MATCHWIN.LEAGUE = BASEBALL.LEAGUE AND MATCHWIN.A_TEAM = BASEBALL.A_TEAM AND MATCHWIN.A_TEAM_PITCHER = BASEBALL.A_TEAM_PITCHER
                LEFT OUTER JOIN
            (

                SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER
                     ,IFNULL(ROUND(homeRunPer/allMatch * 100,1),0) as homeRunWinPer
                     ,100 - IFNULL(ROUND(homeRunPer/allMatch * 100,1),0)  as homeRunLosePer
                FROM (
                         SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER,COUNT(1) allMatch
                         FROM baseball_data A
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FIRST_HOMERUN != '적특'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) A
                         LEFT OUTER JOIN
                     (
                         SELECT A.LEAGUE,A.A_TEAM,A.A_TEAM_PITCHER,COUNT(1) homeRunPer
                         FROM baseball_data A
                         WHERE MATCH_DATE < DATE_ADD(NOW(), INTERVAL -1 DAY )
                           AND LEAGUE != '퓨처스'
                           AND A_TEAM_TOTAL_POINT != 99
                           AND FIRST_HOMERUN != '적특'
                           AND FIRST_HOMERUN = '승리'
                         GROUP BY LEAGUE,A_TEAM,A_TEAM_PITCHER
                     ) B ON A.A_TEAM = B.A_TEAM AND A.A_TEAM_PITCHER = B.A_TEAM_PITCHER AND A.LEAGUE = B.LEAGUE
            ) HOMERUN
            ON MATCHWIN.LEAGUE = HOMERUN.LEAGUE AND MATCHWIN.A_TEAM = HOMERUN.A_TEAM AND MATCHWIN.A_TEAM_PITCHER = HOMERUN.A_TEAM_PITCHER
        ;
        ]]>
    </insert>





    <select id="selectBaseballGroundSummary"  resultType="HashMap">
        SELECT LEAGUE, TEAM, GROUND, WIN_PER, LOSE_PER, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, THIRD_HANDI_WIN_PER, THIRD_HANDI_LOSE_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_HANDI_WIN_PER, FOURTH_HANDI_LOSE_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, FIFTH_HANDI_WIN_PER, FIFTH_HANDI_LOSE_PER, FIFTH_OVER_PER, FIFTH_UNDER_PER, FIRST_STRIKE_PER, FIRST_BALL_PER, FIRST_HOMERUN_PER
        FROM sport.baseball_ground_summary
        ORDER BY LEAGUE,TEAM
        ;
    </select>


    <select id="selectBaseballPitcherSummary"  resultType="HashMap">
        SELECT LEAGUE, TEAM, PITCHER, WIN_PER, LOSE_PER, HANDI_WIN_PER, HANDI_LOSE_PER, OVER_PER, UNDER_PER, THIRD_HANDI_WIN_PER, THIRD_HANDI_LOSE_PER, THIRD_OVER_PER, THIRD_UNDER_PER, FOURTH_HANDI_WIN_PER, FOURTH_HANDI_LOSE_PER, FOURTH_OVER_PER, FOURTH_UNDER_PER, FIFTH_HANDI_WIN_PER, FIFTH_HANDI_LOSE_PER, FIFTH_OVER_PER, FIFTH_UNDER_PER, FIRST_STRIKE_PER, FIRST_BALL_PER, FIRST_HOMERUN_PER
        FROM sport.baseball_pitcher_summary
        ORDER BY LEAGUE,TEAM;
    </select>


    <insert id="truncateBaseballGroundSummary">
        TRUNCATE  sport.baseball_ground_summary;
    </insert>

    <insert id="truncateBaseballPitcherSummary">
        TRUNCATE  sport.baseball_pitcher_summary
    </insert>






    <insert id="insertCoupangDeal" parameterType="blog.model.TempDealVO">
        INSERT INTO coupang.coupang_deal
            (
                      sdid
                    , dealrank
                    , dealname
                    , cate
                    , nmprice
                    , dcprice
                    , dcratio
                    , producturl
                    , imgurl
                    , rdate
             )
        VALUES (
                     #{sdid}
                    ,#{dealrank}
                    ,#{dealName}
                    ,#{cate}
                   ,#{nmPrice}
                   ,#{dcPrice}
                   ,#{dcRatio}
                   ,#{productUrl}
                   ,#{imgUrl}
                   ,now()
               )
    </insert>

    <select id="selectCoupangDeal"  resultType="blog.model.TempDealVO">

        SELECT
               idx
              , sdid
             ,dealrank
             , dealname
             , cate
             , nmprice
             , dcprice
             , dcratio
             , producturl
             , imgurl
        FROM coupang.coupang_deal
        WHERE postid IS NULL
          AND dcprice > 300000
        ORDER BY dealrank
        LIMIT 1;

    </select>

    <update id="updateCoupangDeal" parameterType="blog.model.TempDealVO">

        UPDATE coupang.coupang_deal
            SET postid = #{postid}
        WHERE idx = #{idx};

    </update>


</mapper>